// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`<yarn-audit-results> audit results should match what we had before, and be clean 1`] = `
Object {
  "alluvial-diagram": Array [
    Object {
      "data": Object {
        "dependencies": 22,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 22,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "bar-chart": Array [
    Object {
      "data": Object {
        "dependencies": 20,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 20,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "charts": Array [
    Object {
      "data": Object {
        "dependencies": 93,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 93,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "charts-angular": Array [
    Object {
      "data": Object {
        "dependencies": 986,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 986,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "charts-figma": Array [
    Object {
      "data": Object {
        "dependencies": 232,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 232,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "charts-react": Array [
    Object {
      "data": Object {
        "dependencies": 32,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 32,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "charts-vue": Array [
    Object {
      "data": Object {
        "dependencies": 40,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 40,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "circle-packing": Array [
    Object {
      "data": Object {
        "dependencies": 21,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 21,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "clustered-bar-chart": Array [
    Object {
      "data": Object {
        "dependencies": 20,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 20,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "data-table": Array [
    Object {
      "data": Object {
        "dependencies": 4,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 4,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "dumbbell-plot": Array [
    Object {
      "data": Object {
        "dependencies": 20,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 20,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "heat-map": Array [
    Object {
      "data": Object {
        "dependencies": 20,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 20,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "js": Array [
    Object {
      "data": Object {
        "dependencies": 252,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 252,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "keyboard-instructions": Array [
    Object {
      "data": Object {
        "dependencies": 2,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 2,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "line-chart": Array [
    Object {
      "data": Object {
        "dependencies": 24,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 24,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "parallel-plot": Array [
    Object {
      "data": Object {
        "dependencies": 23,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 23,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "pie-chart": Array [
    Object {
      "data": Object {
        "dependencies": 23,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 23,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "scatter-plot": Array [
    Object {
      "data": Object {
        "dependencies": 20,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 20,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "stacked-bar-chart": Array [
    Object {
      "data": Object {
        "dependencies": 20,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 20,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "types": Array [
    Object {
      "data": Object {
        "dependencies": 1,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 1,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "utils": Array [
    Object {
      "data": Object {
        "dependencies": 189,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 189,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "utils-dev": Array [
    Object {
      "data": Object {
        "dependencies": 181,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 181,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
  "visa-charts-lib": Array [
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2023-09-30T00:31:10.000Z",
          "cves": Array [
            "CVE-2023-44270",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
          },
          "cwe": Array [
            "CWE-74",
            "CWE-144",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>postcss",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>autoprefixer>postcss",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>css-loader>icss-utils>postcss",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>css-loader>postcss-modules-local-by-default>icss-utils>postcss",
              ],
              "version": "7.0.39",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-7fh5-64p2-3v2j",
          "id": 1094544,
          "metadata": null,
          "module_name": "postcss",
          "npm_advisory_id": null,
          "overview": "An issue was discovered in PostCSS before 8.4.31. It affects linters using PostCSS to parse external Cascading Style Sheets (CSS). There may be \`\\\\r\` discrepancies, as demonstrated by \`@font-face{ font:(\\\\r/*);}\` in a rule.

This vulnerability affects linters using PostCSS to parse external untrusted CSS. An attacker can prepare CSS in such a way that it will contains parts parsed by PostCSS as a CSS comment. After processing by PostCSS, it will be included in the PostCSS output in CSS nodes (rules, properties) despite being originally included in a comment.",
          "patched_versions": ">=8.4.31",
          "recommendation": "Upgrade to version 8.4.31 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2023-44270
- https://github.com/postcss/postcss/commit/58cc860b4c1707510c9cd1bc1fa30b423a9ad6c5
- https://github.com/postcss/postcss/blob/main/lib/tokenize.js#L25
- https://github.com/postcss/postcss/releases/tag/8.4.31
- https://github.com/github/advisory-database/issues/2820
- https://github.com/advisories/GHSA-7fh5-64p2-3v2j",
          "reported_by": null,
          "severity": "moderate",
          "title": "PostCSS line return parsing error",
          "updated": "2023-11-05T05:05:37.000Z",
          "url": "https://github.com/advisories/GHSA-7fh5-64p2-3v2j",
          "vulnerable_versions": "<8.4.31",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1094544,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>postcss",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2023-09-30T00:31:10.000Z",
          "cves": Array [
            "CVE-2023-44270",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
          },
          "cwe": Array [
            "CWE-74",
            "CWE-144",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>postcss",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>autoprefixer>postcss",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>css-loader>icss-utils>postcss",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>css-loader>postcss-modules-local-by-default>icss-utils>postcss",
              ],
              "version": "7.0.39",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-7fh5-64p2-3v2j",
          "id": 1094544,
          "metadata": null,
          "module_name": "postcss",
          "npm_advisory_id": null,
          "overview": "An issue was discovered in PostCSS before 8.4.31. It affects linters using PostCSS to parse external Cascading Style Sheets (CSS). There may be \`\\\\r\` discrepancies, as demonstrated by \`@font-face{ font:(\\\\r/*);}\` in a rule.

This vulnerability affects linters using PostCSS to parse external untrusted CSS. An attacker can prepare CSS in such a way that it will contains parts parsed by PostCSS as a CSS comment. After processing by PostCSS, it will be included in the PostCSS output in CSS nodes (rules, properties) despite being originally included in a comment.",
          "patched_versions": ">=8.4.31",
          "recommendation": "Upgrade to version 8.4.31 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2023-44270
- https://github.com/postcss/postcss/commit/58cc860b4c1707510c9cd1bc1fa30b423a9ad6c5
- https://github.com/postcss/postcss/blob/main/lib/tokenize.js#L25
- https://github.com/postcss/postcss/releases/tag/8.4.31
- https://github.com/github/advisory-database/issues/2820
- https://github.com/advisories/GHSA-7fh5-64p2-3v2j",
          "reported_by": null,
          "severity": "moderate",
          "title": "PostCSS line return parsing error",
          "updated": "2023-11-05T05:05:37.000Z",
          "url": "https://github.com/advisories/GHSA-7fh5-64p2-3v2j",
          "vulnerable_versions": "<8.4.31",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1094544,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>autoprefixer>postcss",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2023-09-30T00:31:10.000Z",
          "cves": Array [
            "CVE-2023-44270",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
          },
          "cwe": Array [
            "CWE-74",
            "CWE-144",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>postcss",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>autoprefixer>postcss",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>css-loader>icss-utils>postcss",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>css-loader>postcss-modules-local-by-default>icss-utils>postcss",
              ],
              "version": "7.0.39",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-7fh5-64p2-3v2j",
          "id": 1094544,
          "metadata": null,
          "module_name": "postcss",
          "npm_advisory_id": null,
          "overview": "An issue was discovered in PostCSS before 8.4.31. It affects linters using PostCSS to parse external Cascading Style Sheets (CSS). There may be \`\\\\r\` discrepancies, as demonstrated by \`@font-face{ font:(\\\\r/*);}\` in a rule.

This vulnerability affects linters using PostCSS to parse external untrusted CSS. An attacker can prepare CSS in such a way that it will contains parts parsed by PostCSS as a CSS comment. After processing by PostCSS, it will be included in the PostCSS output in CSS nodes (rules, properties) despite being originally included in a comment.",
          "patched_versions": ">=8.4.31",
          "recommendation": "Upgrade to version 8.4.31 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2023-44270
- https://github.com/postcss/postcss/commit/58cc860b4c1707510c9cd1bc1fa30b423a9ad6c5
- https://github.com/postcss/postcss/blob/main/lib/tokenize.js#L25
- https://github.com/postcss/postcss/releases/tag/8.4.31
- https://github.com/github/advisory-database/issues/2820
- https://github.com/advisories/GHSA-7fh5-64p2-3v2j",
          "reported_by": null,
          "severity": "moderate",
          "title": "PostCSS line return parsing error",
          "updated": "2023-11-05T05:05:37.000Z",
          "url": "https://github.com/advisories/GHSA-7fh5-64p2-3v2j",
          "vulnerable_versions": "<8.4.31",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1094544,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>css-loader>icss-utils>postcss",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2023-09-30T00:31:10.000Z",
          "cves": Array [
            "CVE-2023-44270",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
          },
          "cwe": Array [
            "CWE-74",
            "CWE-144",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>postcss",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>autoprefixer>postcss",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>css-loader>icss-utils>postcss",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>css-loader>postcss-modules-local-by-default>icss-utils>postcss",
              ],
              "version": "7.0.39",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-7fh5-64p2-3v2j",
          "id": 1094544,
          "metadata": null,
          "module_name": "postcss",
          "npm_advisory_id": null,
          "overview": "An issue was discovered in PostCSS before 8.4.31. It affects linters using PostCSS to parse external Cascading Style Sheets (CSS). There may be \`\\\\r\` discrepancies, as demonstrated by \`@font-face{ font:(\\\\r/*);}\` in a rule.

This vulnerability affects linters using PostCSS to parse external untrusted CSS. An attacker can prepare CSS in such a way that it will contains parts parsed by PostCSS as a CSS comment. After processing by PostCSS, it will be included in the PostCSS output in CSS nodes (rules, properties) despite being originally included in a comment.",
          "patched_versions": ">=8.4.31",
          "recommendation": "Upgrade to version 8.4.31 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2023-44270
- https://github.com/postcss/postcss/commit/58cc860b4c1707510c9cd1bc1fa30b423a9ad6c5
- https://github.com/postcss/postcss/blob/main/lib/tokenize.js#L25
- https://github.com/postcss/postcss/releases/tag/8.4.31
- https://github.com/github/advisory-database/issues/2820
- https://github.com/advisories/GHSA-7fh5-64p2-3v2j",
          "reported_by": null,
          "severity": "moderate",
          "title": "PostCSS line return parsing error",
          "updated": "2023-11-05T05:05:37.000Z",
          "url": "https://github.com/advisories/GHSA-7fh5-64p2-3v2j",
          "vulnerable_versions": "<8.4.31",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1094544,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>css-loader>postcss-modules-local-by-default>icss-utils>postcss",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-03-21T18:59:28.000Z",
          "cves": Array [
            "CVE-2024-29180",
          ],
          "cvss": Object {
            "score": 7.4,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N",
          },
          "cwe": Array [
            "CWE-22",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>webpack-dev-middleware",
              ],
              "version": "3.7.3",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-wr3j-pwj9-hqq6",
          "id": 1096729,
          "metadata": null,
          "module_name": "webpack-dev-middleware",
          "npm_advisory_id": null,
          "overview": "### Summary
_The **webpack-dev-middleware** middleware does not validate the supplied URL address sufficiently before returning the local file. It is possible to access any file on the developer's machine._

### Details
The middleware can either work with the physical filesystem when reading the files or it can use a virtualized in-memory _memfs_ filesystem.
If _writeToDisk_ configuration option is set to **true**, the physical filesystem is used:
[https://github.com/webpack/webpack-dev-middleware/blob/7ed24e0b9f53ad1562343f9f517f0f0ad2a70377/src/utils/setupOutputFileSystem.js#L21](https://github.com/webpack/webpack-dev-middleware/blob/7ed24e0b9f53ad1562343f9f517f0f0ad2a70377/src/utils/setupOutputFileSystem.js#L21)

The _**getFilenameFromUrl**_ method is used to parse URL and build the local file path.
The public path prefix is stripped from the URL, and the **unsecaped** path suffix is appended to the _outputPath_:
[https://github.com/webpack/webpack-dev-middleware/blob/7ed24e0b9f53ad1562343f9f517f0f0ad2a70377/src/utils/getFilenameFromUrl.js#L82](https://github.com/webpack/webpack-dev-middleware/blob/7ed24e0b9f53ad1562343f9f517f0f0ad2a70377/src/utils/getFilenameFromUrl.js#L82)
As the URL is not unescaped and normalized automatically before calling the midlleware, it is possible to use _%2e_ and _%2f_ sequences to perform path traversal attack.

### PoC
_A blank project can be created containing the following configuration file **webpack.config.js**:_
\`module.exports = {
  devServer: {
    devMiddleware: {
      writeToDisk: true
    }
  }
};
\`

When started, it is possible to access any local file, e.g. _/etc/passwd_:
\`$ curl localhost:8080/public/..%2f..%2f..%2f..%2f../etc/passwd\`
\`\`\`
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
\`\`\`

### Impact
The developers using _webpack-dev-server_ or _webpack-dev-middleware_ are affected by the issue. When the project is started, an attacker might access any file on the developer's machine and exfiltrate the content (e.g. password, configuration files, private source code, ...).

If the development server is listening on a public IP address (or **0.0.0.0**), an attacker on the local network can access the local files without any interaction from the victim (direct connection to the port).

If the server allows access from third-party domains (CORS, **_Allow-Access-Origin: *_** ), an attacker can send a malicious link to the victim. When visited, the client side script can connect to the local server and exfiltrate the local files.

### Recommendation
The URL should be unescaped and normalized before any further processing.",
          "patched_versions": ">=5.3.4",
          "recommendation": "Upgrade to version 5.3.4 or later",
          "references": "- https://github.com/webpack/webpack-dev-middleware/security/advisories/GHSA-wr3j-pwj9-hqq6
- https://nvd.nist.gov/vuln/detail/CVE-2024-29180
- https://github.com/webpack/webpack-dev-middleware/commit/189c4ac7d2344ec132a4689e74dc837ec5be0132
- https://github.com/webpack/webpack-dev-middleware/commit/9670b3495da518fe667ff3428c5e4cb9f2f3d353
- https://github.com/webpack/webpack-dev-middleware/commit/e10008c762e4d5821ed6990348dabf0d4d93a10e
- https://github.com/webpack/webpack-dev-middleware/blob/7ed24e0b9f53ad1562343f9f517f0f0ad2a70377/src/utils/getFilenameFromUrl.js#L82
- https://github.com/webpack/webpack-dev-middleware/blob/7ed24e0b9f53ad1562343f9f517f0f0ad2a70377/src/utils/setupOutputFileSystem.js#L21
- https://github.com/webpack/webpack-dev-middleware/releases/tag/v5.3.4
- https://github.com/webpack/webpack-dev-middleware/releases/tag/v6.1.2
- https://github.com/webpack/webpack-dev-middleware/releases/tag/v7.1.0
- https://github.com/advisories/GHSA-wr3j-pwj9-hqq6",
          "reported_by": null,
          "severity": "high",
          "title": "Path traversal in webpack-dev-middleware",
          "updated": "2024-03-21T18:59:29.000Z",
          "url": "https://github.com/advisories/GHSA-wr3j-pwj9-hqq6",
          "vulnerable_versions": "<=5.3.3",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1096729,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>webpack-dev-middleware",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4068",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
            "CWE-1050",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
              ],
              "version": "2.3.2",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-grv7-fg5c-xmjg",
          "id": 1098094,
          "metadata": null,
          "module_name": "braces",
          "npm_advisory_id": null,
          "overview": "The NPM package \`braces\` fails to limit the number of characters it can handle, which could lead to Memory Exhaustion. In \`lib/parse.js,\` if a malicious user sends \\"imbalanced braces\\" as input, the parsing will enter a loop, which will cause the program to start allocating heap memory without freeing it at any moment of the loop. Eventually, the JavaScript heap limit is reached, and the program will crash.
",
          "patched_versions": ">=3.0.3",
          "recommendation": "Upgrade to version 3.0.3 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4068
- https://github.com/micromatch/braces/issues/35
- https://devhub.checkmarx.com/cve-details/CVE-2024-4068
- https://github.com/micromatch/braces/blob/98414f9f1fabe021736e26836d8306d5de747e0d/lib/parse.js#L308
- https://github.com/micromatch/braces/pull/37
- https://github.com/micromatch/braces/pull/40
- https://github.com/micromatch/braces/commit/415d660c3002d1ab7e63dbf490c9851da80596ff
- https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "reported_by": null,
          "severity": "high",
          "title": "Uncontrolled resource consumption in braces",
          "updated": "2024-07-05T21:25:08.000Z",
          "url": "https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "vulnerable_versions": "<3.0.3",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098094,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch>braces",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4068",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
            "CWE-1050",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
              ],
              "version": "2.3.2",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-grv7-fg5c-xmjg",
          "id": 1098094,
          "metadata": null,
          "module_name": "braces",
          "npm_advisory_id": null,
          "overview": "The NPM package \`braces\` fails to limit the number of characters it can handle, which could lead to Memory Exhaustion. In \`lib/parse.js,\` if a malicious user sends \\"imbalanced braces\\" as input, the parsing will enter a loop, which will cause the program to start allocating heap memory without freeing it at any moment of the loop. Eventually, the JavaScript heap limit is reached, and the program will crash.
",
          "patched_versions": ">=3.0.3",
          "recommendation": "Upgrade to version 3.0.3 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4068
- https://github.com/micromatch/braces/issues/35
- https://devhub.checkmarx.com/cve-details/CVE-2024-4068
- https://github.com/micromatch/braces/blob/98414f9f1fabe021736e26836d8306d5de747e0d/lib/parse.js#L308
- https://github.com/micromatch/braces/pull/37
- https://github.com/micromatch/braces/pull/40
- https://github.com/micromatch/braces/commit/415d660c3002d1ab7e63dbf490c9851da80596ff
- https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "reported_by": null,
          "severity": "high",
          "title": "Uncontrolled resource consumption in braces",
          "updated": "2024-07-05T21:25:08.000Z",
          "url": "https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "vulnerable_versions": "<3.0.3",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098094,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch>braces",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4068",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
            "CWE-1050",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
              ],
              "version": "2.3.2",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-grv7-fg5c-xmjg",
          "id": 1098094,
          "metadata": null,
          "module_name": "braces",
          "npm_advisory_id": null,
          "overview": "The NPM package \`braces\` fails to limit the number of characters it can handle, which could lead to Memory Exhaustion. In \`lib/parse.js,\` if a malicious user sends \\"imbalanced braces\\" as input, the parsing will enter a loop, which will cause the program to start allocating heap memory without freeing it at any moment of the loop. Eventually, the JavaScript heap limit is reached, and the program will crash.
",
          "patched_versions": ">=3.0.3",
          "recommendation": "Upgrade to version 3.0.3 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4068
- https://github.com/micromatch/braces/issues/35
- https://devhub.checkmarx.com/cve-details/CVE-2024-4068
- https://github.com/micromatch/braces/blob/98414f9f1fabe021736e26836d8306d5de747e0d/lib/parse.js#L308
- https://github.com/micromatch/braces/pull/37
- https://github.com/micromatch/braces/pull/40
- https://github.com/micromatch/braces/commit/415d660c3002d1ab7e63dbf490c9851da80596ff
- https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "reported_by": null,
          "severity": "high",
          "title": "Uncontrolled resource consumption in braces",
          "updated": "2024-07-05T21:25:08.000Z",
          "url": "https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "vulnerable_versions": "<3.0.3",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098094,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4068",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
            "CWE-1050",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
              ],
              "version": "2.3.2",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-grv7-fg5c-xmjg",
          "id": 1098094,
          "metadata": null,
          "module_name": "braces",
          "npm_advisory_id": null,
          "overview": "The NPM package \`braces\` fails to limit the number of characters it can handle, which could lead to Memory Exhaustion. In \`lib/parse.js,\` if a malicious user sends \\"imbalanced braces\\" as input, the parsing will enter a loop, which will cause the program to start allocating heap memory without freeing it at any moment of the loop. Eventually, the JavaScript heap limit is reached, and the program will crash.
",
          "patched_versions": ">=3.0.3",
          "recommendation": "Upgrade to version 3.0.3 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4068
- https://github.com/micromatch/braces/issues/35
- https://devhub.checkmarx.com/cve-details/CVE-2024-4068
- https://github.com/micromatch/braces/blob/98414f9f1fabe021736e26836d8306d5de747e0d/lib/parse.js#L308
- https://github.com/micromatch/braces/pull/37
- https://github.com/micromatch/braces/pull/40
- https://github.com/micromatch/braces/commit/415d660c3002d1ab7e63dbf490c9851da80596ff
- https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "reported_by": null,
          "severity": "high",
          "title": "Uncontrolled resource consumption in braces",
          "updated": "2024-07-05T21:25:08.000Z",
          "url": "https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "vulnerable_versions": "<3.0.3",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098094,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4067",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>micromatch",
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>fork-ts-checker-webpack-plugin>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>cpy>globby>fast-glob>micromatch",
              ],
              "version": "3.1.10",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-952p-6rrq-rcjv",
          "id": 1098681,
          "metadata": null,
          "module_name": "micromatch",
          "npm_advisory_id": null,
          "overview": "The NPM package \`micromatch\` prior to version 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in \`micromatch.braces()\` in \`index.js\` because the pattern \`.*\` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persisted prior to https://github.com/micromatch/micromatch/pull/266. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching.
",
          "patched_versions": ">=4.0.8",
          "recommendation": "Upgrade to version 4.0.8 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4067
- https://github.com/micromatch/micromatch/issues/243
- https://github.com/micromatch/micromatch/pull/247
- https://devhub.checkmarx.com/cve-details/CVE-2024-4067
- https://github.com/micromatch/micromatch/blob/2c56a8604b68c1099e7bc0f807ce0865a339747a/index.js#L448
- https://github.com/micromatch/micromatch/commit/500d5d6f42f0e8dfa1cb5464c6cb420b1b6aaaa0
- https://github.com/micromatch/micromatch/pull/266
- https://github.com/micromatch/micromatch/commit/03aa8052171e878897eee5d7bb2ae0ae83ec2ade
- https://advisory.checkmarx.net/advisory/CVE-2024-4067
- https://github.com/micromatch/micromatch/releases/tag/4.0.8
- https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "reported_by": null,
          "severity": "moderate",
          "title": "Regular Expression Denial of Service (ReDoS) in micromatch",
          "updated": "2024-08-28T13:12:27.000Z",
          "url": "https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "vulnerable_versions": "<4.0.8",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098681,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4067",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>micromatch",
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>fork-ts-checker-webpack-plugin>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>cpy>globby>fast-glob>micromatch",
              ],
              "version": "3.1.10",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-952p-6rrq-rcjv",
          "id": 1098681,
          "metadata": null,
          "module_name": "micromatch",
          "npm_advisory_id": null,
          "overview": "The NPM package \`micromatch\` prior to version 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in \`micromatch.braces()\` in \`index.js\` because the pattern \`.*\` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persisted prior to https://github.com/micromatch/micromatch/pull/266. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching.
",
          "patched_versions": ">=4.0.8",
          "recommendation": "Upgrade to version 4.0.8 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4067
- https://github.com/micromatch/micromatch/issues/243
- https://github.com/micromatch/micromatch/pull/247
- https://devhub.checkmarx.com/cve-details/CVE-2024-4067
- https://github.com/micromatch/micromatch/blob/2c56a8604b68c1099e7bc0f807ce0865a339747a/index.js#L448
- https://github.com/micromatch/micromatch/commit/500d5d6f42f0e8dfa1cb5464c6cb420b1b6aaaa0
- https://github.com/micromatch/micromatch/pull/266
- https://github.com/micromatch/micromatch/commit/03aa8052171e878897eee5d7bb2ae0ae83ec2ade
- https://advisory.checkmarx.net/advisory/CVE-2024-4067
- https://github.com/micromatch/micromatch/releases/tag/4.0.8
- https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "reported_by": null,
          "severity": "moderate",
          "title": "Regular Expression Denial of Service (ReDoS) in micromatch",
          "updated": "2024-08-28T13:12:27.000Z",
          "url": "https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "vulnerable_versions": "<4.0.8",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098681,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4067",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>micromatch",
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>fork-ts-checker-webpack-plugin>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>cpy>globby>fast-glob>micromatch",
              ],
              "version": "3.1.10",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-952p-6rrq-rcjv",
          "id": 1098681,
          "metadata": null,
          "module_name": "micromatch",
          "npm_advisory_id": null,
          "overview": "The NPM package \`micromatch\` prior to version 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in \`micromatch.braces()\` in \`index.js\` because the pattern \`.*\` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persisted prior to https://github.com/micromatch/micromatch/pull/266. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching.
",
          "patched_versions": ">=4.0.8",
          "recommendation": "Upgrade to version 4.0.8 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4067
- https://github.com/micromatch/micromatch/issues/243
- https://github.com/micromatch/micromatch/pull/247
- https://devhub.checkmarx.com/cve-details/CVE-2024-4067
- https://github.com/micromatch/micromatch/blob/2c56a8604b68c1099e7bc0f807ce0865a339747a/index.js#L448
- https://github.com/micromatch/micromatch/commit/500d5d6f42f0e8dfa1cb5464c6cb420b1b6aaaa0
- https://github.com/micromatch/micromatch/pull/266
- https://github.com/micromatch/micromatch/commit/03aa8052171e878897eee5d7bb2ae0ae83ec2ade
- https://advisory.checkmarx.net/advisory/CVE-2024-4067
- https://github.com/micromatch/micromatch/releases/tag/4.0.8
- https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "reported_by": null,
          "severity": "moderate",
          "title": "Regular Expression Denial of Service (ReDoS) in micromatch",
          "updated": "2024-08-28T13:12:27.000Z",
          "url": "https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "vulnerable_versions": "<4.0.8",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098681,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4067",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>micromatch",
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>fork-ts-checker-webpack-plugin>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>cpy>globby>fast-glob>micromatch",
              ],
              "version": "3.1.10",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-952p-6rrq-rcjv",
          "id": 1098681,
          "metadata": null,
          "module_name": "micromatch",
          "npm_advisory_id": null,
          "overview": "The NPM package \`micromatch\` prior to version 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in \`micromatch.braces()\` in \`index.js\` because the pattern \`.*\` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persisted prior to https://github.com/micromatch/micromatch/pull/266. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching.
",
          "patched_versions": ">=4.0.8",
          "recommendation": "Upgrade to version 4.0.8 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4067
- https://github.com/micromatch/micromatch/issues/243
- https://github.com/micromatch/micromatch/pull/247
- https://devhub.checkmarx.com/cve-details/CVE-2024-4067
- https://github.com/micromatch/micromatch/blob/2c56a8604b68c1099e7bc0f807ce0865a339747a/index.js#L448
- https://github.com/micromatch/micromatch/commit/500d5d6f42f0e8dfa1cb5464c6cb420b1b6aaaa0
- https://github.com/micromatch/micromatch/pull/266
- https://github.com/micromatch/micromatch/commit/03aa8052171e878897eee5d7bb2ae0ae83ec2ade
- https://advisory.checkmarx.net/advisory/CVE-2024-4067
- https://github.com/micromatch/micromatch/releases/tag/4.0.8
- https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "reported_by": null,
          "severity": "moderate",
          "title": "Regular Expression Denial of Service (ReDoS) in micromatch",
          "updated": "2024-08-28T13:12:27.000Z",
          "url": "https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "vulnerable_versions": "<4.0.8",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098681,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4067",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>micromatch",
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>fork-ts-checker-webpack-plugin>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>cpy>globby>fast-glob>micromatch",
              ],
              "version": "3.1.10",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-952p-6rrq-rcjv",
          "id": 1098681,
          "metadata": null,
          "module_name": "micromatch",
          "npm_advisory_id": null,
          "overview": "The NPM package \`micromatch\` prior to version 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in \`micromatch.braces()\` in \`index.js\` because the pattern \`.*\` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persisted prior to https://github.com/micromatch/micromatch/pull/266. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching.
",
          "patched_versions": ">=4.0.8",
          "recommendation": "Upgrade to version 4.0.8 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4067
- https://github.com/micromatch/micromatch/issues/243
- https://github.com/micromatch/micromatch/pull/247
- https://devhub.checkmarx.com/cve-details/CVE-2024-4067
- https://github.com/micromatch/micromatch/blob/2c56a8604b68c1099e7bc0f807ce0865a339747a/index.js#L448
- https://github.com/micromatch/micromatch/commit/500d5d6f42f0e8dfa1cb5464c6cb420b1b6aaaa0
- https://github.com/micromatch/micromatch/pull/266
- https://github.com/micromatch/micromatch/commit/03aa8052171e878897eee5d7bb2ae0ae83ec2ade
- https://advisory.checkmarx.net/advisory/CVE-2024-4067
- https://github.com/micromatch/micromatch/releases/tag/4.0.8
- https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "reported_by": null,
          "severity": "moderate",
          "title": "Regular Expression Denial of Service (ReDoS) in micromatch",
          "updated": "2024-08-28T13:12:27.000Z",
          "url": "https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "vulnerable_versions": "<4.0.8",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098681,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>fork-ts-checker-webpack-plugin>micromatch",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4067",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>micromatch",
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>fork-ts-checker-webpack-plugin>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>cpy>globby>fast-glob>micromatch",
              ],
              "version": "3.1.10",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-952p-6rrq-rcjv",
          "id": 1098681,
          "metadata": null,
          "module_name": "micromatch",
          "npm_advisory_id": null,
          "overview": "The NPM package \`micromatch\` prior to version 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in \`micromatch.braces()\` in \`index.js\` because the pattern \`.*\` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persisted prior to https://github.com/micromatch/micromatch/pull/266. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching.
",
          "patched_versions": ">=4.0.8",
          "recommendation": "Upgrade to version 4.0.8 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4067
- https://github.com/micromatch/micromatch/issues/243
- https://github.com/micromatch/micromatch/pull/247
- https://devhub.checkmarx.com/cve-details/CVE-2024-4067
- https://github.com/micromatch/micromatch/blob/2c56a8604b68c1099e7bc0f807ce0865a339747a/index.js#L448
- https://github.com/micromatch/micromatch/commit/500d5d6f42f0e8dfa1cb5464c6cb420b1b6aaaa0
- https://github.com/micromatch/micromatch/pull/266
- https://github.com/micromatch/micromatch/commit/03aa8052171e878897eee5d7bb2ae0ae83ec2ade
- https://advisory.checkmarx.net/advisory/CVE-2024-4067
- https://github.com/micromatch/micromatch/releases/tag/4.0.8
- https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "reported_by": null,
          "severity": "moderate",
          "title": "Regular Expression Denial of Service (ReDoS) in micromatch",
          "updated": "2024-08-28T13:12:27.000Z",
          "url": "https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "vulnerable_versions": "<4.0.8",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098681,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>cpy>globby>fast-glob>micromatch",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-03-22T16:57:05.000Z",
          "cves": Array [
            "CVE-2024-28863",
          ],
          "cvss": Object {
            "score": 6.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "lerna>tar",
                "lerna>pacote>tar",
                "lerna>@npmcli/run-script>node-gyp>tar",
                "lerna>pacote>@npmcli/run-script>node-gyp>tar",
                "lerna>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>terser-webpack-plugin>cacache>tar",
                "lerna>@lerna/create>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>sigstore>@sigstore/tuf>tuf-js>make-fetch-happen>cacache>tar",
              ],
              "version": "4.4.19",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-f5x3-32g6-xq36",
          "id": 1097493,
          "metadata": null,
          "module_name": "tar",
          "npm_advisory_id": null,
          "overview": "## Description: 
During some analysis today on npm's \`node-tar\` package I came across the folder creation process, Basicly if you provide node-tar with a path like this \`./a/b/c/foo.txt\` it would create every folder and sub-folder here a, b and c until it reaches the last folder to create \`foo.txt\`, In-this case I noticed that there's no validation at all on the amount of folders being created, that said we're actually able to CPU and memory consume the system running node-tar and even crash the nodejs client within few seconds of running it using a path with too many sub-folders inside

## Steps To Reproduce:
You can reproduce this issue by downloading the tar file I provided in the resources and using node-tar to extract it, you should get the same behavior as the video

## Proof Of Concept:
Here's a [video](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3i7uojw8s52psar6pg8zkdo4h9io?response-content-disposition=attachment%3B%20filename%3D%22tar-dos-poc.webm%22%3B%20filename%2A%3DUTF-8%27%27tar-dos-poc.webm&response-content-type=video%2Fwebm&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1e8235d885f1d61529b7d6b23ea3a0780c300c91d86e925dd8310d5b661ddbe2) show-casing the exploit: 

## Impact

Denial of service by crashing the nodejs client when attempting to parse a tar archive, make it run out of heap memory and consuming server CPU and memory resources

## Report resources
[payload.txt](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1e83ayb5dd3350fvj3gst0mqixwk?response-content-disposition=attachment%3B%20filename%3D%22payload.txt%22%3B%20filename%2A%3DUTF-8%27%27payload.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bad9fe731f05a63a950f99828125653a8c1254750fe0ca7be882e89ecdd449ae)
[archeive.tar.gz](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ymkuh4xnfdcf1soeyi7jc2x4yt2i?response-content-disposition=attachment%3B%20filename%3D%22archive.tar.gz%22%3B%20filename%2A%3DUTF-8%27%27archive.tar.gz&response-content-type=application%2Fx-tar&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5e2c0d4b4de40373ac0fe91908c2659141a6dd4ab850271cc26042a3885c82ea)

## Note
This report was originally reported to GitHub bug bounty program, they asked me to report it to you a month ago",
          "patched_versions": ">=6.2.1",
          "recommendation": "Upgrade to version 6.2.1 or later",
          "references": "- https://github.com/isaacs/node-tar/security/advisories/GHSA-f5x3-32g6-xq36
- https://nvd.nist.gov/vuln/detail/CVE-2024-28863
- https://github.com/isaacs/node-tar/commit/fe8cd57da5686f8695415414bda49206a545f7f7
- https://security.netapp.com/advisory/ntap-20240524-0005
- https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "reported_by": null,
          "severity": "moderate",
          "title": "Denial of service while parsing a tar file due to lack of folders count validation",
          "updated": "2024-06-10T18:30:53.000Z",
          "url": "https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "vulnerable_versions": "<6.2.1",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1097493,
          "optional": false,
          "path": "lerna>tar",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2023-06-21T06:30:28.000Z",
          "cves": Array [
            "CVE-2022-25883",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@commitlint/cli>@commitlint/lint>@commitlint/is-ignored>semver",
              ],
              "version": "7.3.2",
            },
            Object {
              "paths": Array [
                "lerna>@lerna/legacy-package-management>semver",
              ],
              "version": "7.3.8",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-c2qf-rxjj-qqgw",
          "id": 1098562,
          "metadata": null,
          "module_name": "semver",
          "npm_advisory_id": null,
          "overview": "Versions of the package semver before 7.5.2 on the 7.x branch, before 6.3.1 on the 6.x branch, and all other versions before 5.7.2 are vulnerable to Regular Expression Denial of Service (ReDoS) via the function new Range, when untrusted user data is provided as a range.",
          "patched_versions": ">=7.5.2",
          "recommendation": "Upgrade to version 7.5.2 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2022-25883
- https://github.com/npm/node-semver/pull/564
- https://github.com/npm/node-semver/commit/717534ee353682f3bcf33e60a8af4292626d4441
- https://security.snyk.io/vuln/SNYK-JS-SEMVER-3247795
- https://github.com/npm/node-semver/blob/main/classes/range.js#L97-L104
- https://github.com/npm/node-semver/blob/main/internal/re.js#L138
- https://github.com/npm/node-semver/blob/main/internal/re.js#L160
- https://github.com/npm/node-semver/pull/585
- https://github.com/npm/node-semver/commit/928e56d21150da0413a3333a3148b20e741a920c
- https://github.com/npm/node-semver/pull/593
- https://github.com/npm/node-semver/commit/2f8fd41487acf380194579ecb6f8b1bbfe116be0
- https://github.com/advisories/GHSA-c2qf-rxjj-qqgw",
          "reported_by": null,
          "severity": "high",
          "title": "semver vulnerable to Regular Expression Denial of Service",
          "updated": "2024-08-08T16:23:02.000Z",
          "url": "https://github.com/advisories/GHSA-c2qf-rxjj-qqgw",
          "vulnerable_versions": ">=7.0.0 <7.5.2",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098562,
          "optional": false,
          "path": "lerna>@lerna/legacy-package-management>semver",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4068",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
            "CWE-1050",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
              ],
              "version": "2.3.2",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-grv7-fg5c-xmjg",
          "id": 1098094,
          "metadata": null,
          "module_name": "braces",
          "npm_advisory_id": null,
          "overview": "The NPM package \`braces\` fails to limit the number of characters it can handle, which could lead to Memory Exhaustion. In \`lib/parse.js,\` if a malicious user sends \\"imbalanced braces\\" as input, the parsing will enter a loop, which will cause the program to start allocating heap memory without freeing it at any moment of the loop. Eventually, the JavaScript heap limit is reached, and the program will crash.
",
          "patched_versions": ">=3.0.3",
          "recommendation": "Upgrade to version 3.0.3 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4068
- https://github.com/micromatch/braces/issues/35
- https://devhub.checkmarx.com/cve-details/CVE-2024-4068
- https://github.com/micromatch/braces/blob/98414f9f1fabe021736e26836d8306d5de747e0d/lib/parse.js#L308
- https://github.com/micromatch/braces/pull/37
- https://github.com/micromatch/braces/pull/40
- https://github.com/micromatch/braces/commit/415d660c3002d1ab7e63dbf490c9851da80596ff
- https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "reported_by": null,
          "severity": "high",
          "title": "Uncontrolled resource consumption in braces",
          "updated": "2024-07-05T21:25:08.000Z",
          "url": "https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "vulnerable_versions": "<3.0.3",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098094,
          "optional": false,
          "path": "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch>braces",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4068",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
            "CWE-1050",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
              ],
              "version": "2.3.2",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-grv7-fg5c-xmjg",
          "id": 1098094,
          "metadata": null,
          "module_name": "braces",
          "npm_advisory_id": null,
          "overview": "The NPM package \`braces\` fails to limit the number of characters it can handle, which could lead to Memory Exhaustion. In \`lib/parse.js,\` if a malicious user sends \\"imbalanced braces\\" as input, the parsing will enter a loop, which will cause the program to start allocating heap memory without freeing it at any moment of the loop. Eventually, the JavaScript heap limit is reached, and the program will crash.
",
          "patched_versions": ">=3.0.3",
          "recommendation": "Upgrade to version 3.0.3 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4068
- https://github.com/micromatch/braces/issues/35
- https://devhub.checkmarx.com/cve-details/CVE-2024-4068
- https://github.com/micromatch/braces/blob/98414f9f1fabe021736e26836d8306d5de747e0d/lib/parse.js#L308
- https://github.com/micromatch/braces/pull/37
- https://github.com/micromatch/braces/pull/40
- https://github.com/micromatch/braces/commit/415d660c3002d1ab7e63dbf490c9851da80596ff
- https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "reported_by": null,
          "severity": "high",
          "title": "Uncontrolled resource consumption in braces",
          "updated": "2024-07-05T21:25:08.000Z",
          "url": "https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "vulnerable_versions": "<3.0.3",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098094,
          "optional": false,
          "path": "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch>braces",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4068",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
            "CWE-1050",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
              ],
              "version": "2.3.2",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-grv7-fg5c-xmjg",
          "id": 1098094,
          "metadata": null,
          "module_name": "braces",
          "npm_advisory_id": null,
          "overview": "The NPM package \`braces\` fails to limit the number of characters it can handle, which could lead to Memory Exhaustion. In \`lib/parse.js,\` if a malicious user sends \\"imbalanced braces\\" as input, the parsing will enter a loop, which will cause the program to start allocating heap memory without freeing it at any moment of the loop. Eventually, the JavaScript heap limit is reached, and the program will crash.
",
          "patched_versions": ">=3.0.3",
          "recommendation": "Upgrade to version 3.0.3 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4068
- https://github.com/micromatch/braces/issues/35
- https://devhub.checkmarx.com/cve-details/CVE-2024-4068
- https://github.com/micromatch/braces/blob/98414f9f1fabe021736e26836d8306d5de747e0d/lib/parse.js#L308
- https://github.com/micromatch/braces/pull/37
- https://github.com/micromatch/braces/pull/40
- https://github.com/micromatch/braces/commit/415d660c3002d1ab7e63dbf490c9851da80596ff
- https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "reported_by": null,
          "severity": "high",
          "title": "Uncontrolled resource consumption in braces",
          "updated": "2024-07-05T21:25:08.000Z",
          "url": "https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "vulnerable_versions": "<3.0.3",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098094,
          "optional": false,
          "path": "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4068",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
            "CWE-1050",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
              ],
              "version": "2.3.2",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-grv7-fg5c-xmjg",
          "id": 1098094,
          "metadata": null,
          "module_name": "braces",
          "npm_advisory_id": null,
          "overview": "The NPM package \`braces\` fails to limit the number of characters it can handle, which could lead to Memory Exhaustion. In \`lib/parse.js,\` if a malicious user sends \\"imbalanced braces\\" as input, the parsing will enter a loop, which will cause the program to start allocating heap memory without freeing it at any moment of the loop. Eventually, the JavaScript heap limit is reached, and the program will crash.
",
          "patched_versions": ">=3.0.3",
          "recommendation": "Upgrade to version 3.0.3 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4068
- https://github.com/micromatch/braces/issues/35
- https://devhub.checkmarx.com/cve-details/CVE-2024-4068
- https://github.com/micromatch/braces/blob/98414f9f1fabe021736e26836d8306d5de747e0d/lib/parse.js#L308
- https://github.com/micromatch/braces/pull/37
- https://github.com/micromatch/braces/pull/40
- https://github.com/micromatch/braces/commit/415d660c3002d1ab7e63dbf490c9851da80596ff
- https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "reported_by": null,
          "severity": "high",
          "title": "Uncontrolled resource consumption in braces",
          "updated": "2024-07-05T21:25:08.000Z",
          "url": "https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "vulnerable_versions": "<3.0.3",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098094,
          "optional": false,
          "path": "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4067",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>micromatch",
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>fork-ts-checker-webpack-plugin>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>cpy>globby>fast-glob>micromatch",
              ],
              "version": "3.1.10",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-952p-6rrq-rcjv",
          "id": 1098681,
          "metadata": null,
          "module_name": "micromatch",
          "npm_advisory_id": null,
          "overview": "The NPM package \`micromatch\` prior to version 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in \`micromatch.braces()\` in \`index.js\` because the pattern \`.*\` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persisted prior to https://github.com/micromatch/micromatch/pull/266. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching.
",
          "patched_versions": ">=4.0.8",
          "recommendation": "Upgrade to version 4.0.8 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4067
- https://github.com/micromatch/micromatch/issues/243
- https://github.com/micromatch/micromatch/pull/247
- https://devhub.checkmarx.com/cve-details/CVE-2024-4067
- https://github.com/micromatch/micromatch/blob/2c56a8604b68c1099e7bc0f807ce0865a339747a/index.js#L448
- https://github.com/micromatch/micromatch/commit/500d5d6f42f0e8dfa1cb5464c6cb420b1b6aaaa0
- https://github.com/micromatch/micromatch/pull/266
- https://github.com/micromatch/micromatch/commit/03aa8052171e878897eee5d7bb2ae0ae83ec2ade
- https://advisory.checkmarx.net/advisory/CVE-2024-4067
- https://github.com/micromatch/micromatch/releases/tag/4.0.8
- https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "reported_by": null,
          "severity": "moderate",
          "title": "Regular Expression Denial of Service (ReDoS) in micromatch",
          "updated": "2024-08-28T13:12:27.000Z",
          "url": "https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "vulnerable_versions": "<4.0.8",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098681,
          "optional": false,
          "path": "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4067",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>micromatch",
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>fork-ts-checker-webpack-plugin>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>cpy>globby>fast-glob>micromatch",
              ],
              "version": "3.1.10",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-952p-6rrq-rcjv",
          "id": 1098681,
          "metadata": null,
          "module_name": "micromatch",
          "npm_advisory_id": null,
          "overview": "The NPM package \`micromatch\` prior to version 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in \`micromatch.braces()\` in \`index.js\` because the pattern \`.*\` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persisted prior to https://github.com/micromatch/micromatch/pull/266. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching.
",
          "patched_versions": ">=4.0.8",
          "recommendation": "Upgrade to version 4.0.8 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4067
- https://github.com/micromatch/micromatch/issues/243
- https://github.com/micromatch/micromatch/pull/247
- https://devhub.checkmarx.com/cve-details/CVE-2024-4067
- https://github.com/micromatch/micromatch/blob/2c56a8604b68c1099e7bc0f807ce0865a339747a/index.js#L448
- https://github.com/micromatch/micromatch/commit/500d5d6f42f0e8dfa1cb5464c6cb420b1b6aaaa0
- https://github.com/micromatch/micromatch/pull/266
- https://github.com/micromatch/micromatch/commit/03aa8052171e878897eee5d7bb2ae0ae83ec2ade
- https://advisory.checkmarx.net/advisory/CVE-2024-4067
- https://github.com/micromatch/micromatch/releases/tag/4.0.8
- https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "reported_by": null,
          "severity": "moderate",
          "title": "Regular Expression Denial of Service (ReDoS) in micromatch",
          "updated": "2024-08-28T13:12:27.000Z",
          "url": "https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "vulnerable_versions": "<4.0.8",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098681,
          "optional": false,
          "path": "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4067",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>micromatch",
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>fork-ts-checker-webpack-plugin>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>cpy>globby>fast-glob>micromatch",
              ],
              "version": "3.1.10",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-952p-6rrq-rcjv",
          "id": 1098681,
          "metadata": null,
          "module_name": "micromatch",
          "npm_advisory_id": null,
          "overview": "The NPM package \`micromatch\` prior to version 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in \`micromatch.braces()\` in \`index.js\` because the pattern \`.*\` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persisted prior to https://github.com/micromatch/micromatch/pull/266. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching.
",
          "patched_versions": ">=4.0.8",
          "recommendation": "Upgrade to version 4.0.8 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4067
- https://github.com/micromatch/micromatch/issues/243
- https://github.com/micromatch/micromatch/pull/247
- https://devhub.checkmarx.com/cve-details/CVE-2024-4067
- https://github.com/micromatch/micromatch/blob/2c56a8604b68c1099e7bc0f807ce0865a339747a/index.js#L448
- https://github.com/micromatch/micromatch/commit/500d5d6f42f0e8dfa1cb5464c6cb420b1b6aaaa0
- https://github.com/micromatch/micromatch/pull/266
- https://github.com/micromatch/micromatch/commit/03aa8052171e878897eee5d7bb2ae0ae83ec2ade
- https://advisory.checkmarx.net/advisory/CVE-2024-4067
- https://github.com/micromatch/micromatch/releases/tag/4.0.8
- https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "reported_by": null,
          "severity": "moderate",
          "title": "Regular Expression Denial of Service (ReDoS) in micromatch",
          "updated": "2024-08-28T13:12:27.000Z",
          "url": "https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "vulnerable_versions": "<4.0.8",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098681,
          "optional": false,
          "path": "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4067",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>micromatch",
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>fork-ts-checker-webpack-plugin>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>cpy>globby>fast-glob>micromatch",
              ],
              "version": "3.1.10",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-952p-6rrq-rcjv",
          "id": 1098681,
          "metadata": null,
          "module_name": "micromatch",
          "npm_advisory_id": null,
          "overview": "The NPM package \`micromatch\` prior to version 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in \`micromatch.braces()\` in \`index.js\` because the pattern \`.*\` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persisted prior to https://github.com/micromatch/micromatch/pull/266. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching.
",
          "patched_versions": ">=4.0.8",
          "recommendation": "Upgrade to version 4.0.8 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4067
- https://github.com/micromatch/micromatch/issues/243
- https://github.com/micromatch/micromatch/pull/247
- https://devhub.checkmarx.com/cve-details/CVE-2024-4067
- https://github.com/micromatch/micromatch/blob/2c56a8604b68c1099e7bc0f807ce0865a339747a/index.js#L448
- https://github.com/micromatch/micromatch/commit/500d5d6f42f0e8dfa1cb5464c6cb420b1b6aaaa0
- https://github.com/micromatch/micromatch/pull/266
- https://github.com/micromatch/micromatch/commit/03aa8052171e878897eee5d7bb2ae0ae83ec2ade
- https://advisory.checkmarx.net/advisory/CVE-2024-4067
- https://github.com/micromatch/micromatch/releases/tag/4.0.8
- https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "reported_by": null,
          "severity": "moderate",
          "title": "Regular Expression Denial of Service (ReDoS) in micromatch",
          "updated": "2024-08-28T13:12:27.000Z",
          "url": "https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "vulnerable_versions": "<4.0.8",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098681,
          "optional": false,
          "path": "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4067",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>micromatch",
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>fork-ts-checker-webpack-plugin>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>cpy>globby>fast-glob>micromatch",
              ],
              "version": "3.1.10",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-952p-6rrq-rcjv",
          "id": 1098681,
          "metadata": null,
          "module_name": "micromatch",
          "npm_advisory_id": null,
          "overview": "The NPM package \`micromatch\` prior to version 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in \`micromatch.braces()\` in \`index.js\` because the pattern \`.*\` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persisted prior to https://github.com/micromatch/micromatch/pull/266. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching.
",
          "patched_versions": ">=4.0.8",
          "recommendation": "Upgrade to version 4.0.8 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4067
- https://github.com/micromatch/micromatch/issues/243
- https://github.com/micromatch/micromatch/pull/247
- https://devhub.checkmarx.com/cve-details/CVE-2024-4067
- https://github.com/micromatch/micromatch/blob/2c56a8604b68c1099e7bc0f807ce0865a339747a/index.js#L448
- https://github.com/micromatch/micromatch/commit/500d5d6f42f0e8dfa1cb5464c6cb420b1b6aaaa0
- https://github.com/micromatch/micromatch/pull/266
- https://github.com/micromatch/micromatch/commit/03aa8052171e878897eee5d7bb2ae0ae83ec2ade
- https://advisory.checkmarx.net/advisory/CVE-2024-4067
- https://github.com/micromatch/micromatch/releases/tag/4.0.8
- https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "reported_by": null,
          "severity": "moderate",
          "title": "Regular Expression Denial of Service (ReDoS) in micromatch",
          "updated": "2024-08-28T13:12:27.000Z",
          "url": "https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "vulnerable_versions": "<4.0.8",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098681,
          "optional": false,
          "path": "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>micromatch",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4067",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>micromatch",
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>fork-ts-checker-webpack-plugin>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>cpy>globby>fast-glob>micromatch",
              ],
              "version": "3.1.10",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-952p-6rrq-rcjv",
          "id": 1098681,
          "metadata": null,
          "module_name": "micromatch",
          "npm_advisory_id": null,
          "overview": "The NPM package \`micromatch\` prior to version 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in \`micromatch.braces()\` in \`index.js\` because the pattern \`.*\` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persisted prior to https://github.com/micromatch/micromatch/pull/266. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching.
",
          "patched_versions": ">=4.0.8",
          "recommendation": "Upgrade to version 4.0.8 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4067
- https://github.com/micromatch/micromatch/issues/243
- https://github.com/micromatch/micromatch/pull/247
- https://devhub.checkmarx.com/cve-details/CVE-2024-4067
- https://github.com/micromatch/micromatch/blob/2c56a8604b68c1099e7bc0f807ce0865a339747a/index.js#L448
- https://github.com/micromatch/micromatch/commit/500d5d6f42f0e8dfa1cb5464c6cb420b1b6aaaa0
- https://github.com/micromatch/micromatch/pull/266
- https://github.com/micromatch/micromatch/commit/03aa8052171e878897eee5d7bb2ae0ae83ec2ade
- https://advisory.checkmarx.net/advisory/CVE-2024-4067
- https://github.com/micromatch/micromatch/releases/tag/4.0.8
- https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "reported_by": null,
          "severity": "moderate",
          "title": "Regular Expression Denial of Service (ReDoS) in micromatch",
          "updated": "2024-08-28T13:12:27.000Z",
          "url": "https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "vulnerable_versions": "<4.0.8",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098681,
          "optional": false,
          "path": "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>anymatch>micromatch",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-06-17T19:09:10.000Z",
          "cves": Array [
            "CVE-2024-37890",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-476",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>ws",
              ],
              "version": "8.4.2",
            },
            Object {
              "paths": Array [
                "jest-cli>jest-config>jest-environment-jsdom>jsdom>ws",
                "jest>@jest/core>jest-config>jest-environment-jsdom>jsdom>ws",
                "jest>jest-cli>@jest/core>jest-config>jest-environment-jsdom>jsdom>ws",
                "jest>jest-cli>@jest/core>jest-config>jest-runner>jest-environment-jsdom>jsdom>ws",
              ],
              "version": "8.4.2",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-3h5v-q93c-6h6q",
          "id": 1098392,
          "metadata": null,
          "module_name": "ws",
          "npm_advisory_id": null,
          "overview": "### Impact

A request with a number of headers exceeding the[\`server.maxHeadersCount\`][] threshold could be used to crash a ws server.

### Proof of concept

\`\`\`js
const http = require('http');
const WebSocket = require('ws');

const wss = new WebSocket.Server({ port: 0 }, function () {
  const chars = \\"!#$%&'*+-.0123456789abcdefghijklmnopqrstuvwxyz^_\`|~\\".split('');
  const headers = {};
  let count = 0;

  for (let i = 0; i < chars.length; i++) {
    if (count === 2000) break;

    for (let j = 0; j < chars.length; j++) {
      const key = chars[i] + chars[j];
      headers[key] = 'x';

      if (++count === 2000) break;
    }
  }

  headers.Connection = 'Upgrade';
  headers.Upgrade = 'websocket';
  headers['Sec-WebSocket-Key'] = 'dGhlIHNhbXBsZSBub25jZQ==';
  headers['Sec-WebSocket-Version'] = '13';

  const request = http.request({
    headers: headers,
    host: '127.0.0.1',
    port: wss.address().port
  });

  request.end();
});
\`\`\`

### Patches

The vulnerability was fixed in ws@8.17.1 (https://github.com/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c) and backported to ws@7.5.10 (https://github.com/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f), ws@6.2.3 (https://github.com/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63), and ws@5.2.4 (https://github.com/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e)

### Workarounds

In vulnerable versions of ws, the issue can be mitigated in the following ways:

1. Reduce the maximum allowed length of the request headers using the [\`--max-http-header-size=size\`][] and/or the [\`maxHeaderSize\`][] options so that no more headers than the \`server.maxHeadersCount\` limit can be sent.
2. Set \`server.maxHeadersCount\` to \`0\` so that no limit is applied.

### Credits

The vulnerability was reported by [Ryan LaPointe](https://github.com/rrlapointe) in https://github.com/websockets/ws/issues/2230.

### References

- https://github.com/websockets/ws/issues/2230
- https://github.com/websockets/ws/pull/2231

[\`--max-http-header-size=size\`]: https://nodejs.org/api/cli.html#--max-http-header-sizesize
[\`maxHeaderSize\`]: https://nodejs.org/api/http.html#httpcreateserveroptions-requestlistener
[\`server.maxHeadersCount\`]: https://nodejs.org/api/http.html#servermaxheaderscount
",
          "patched_versions": ">=8.17.1",
          "recommendation": "Upgrade to version 8.17.1 or later",
          "references": "- https://github.com/websockets/ws/security/advisories/GHSA-3h5v-q93c-6h6q
- https://github.com/websockets/ws/issues/2230
- https://github.com/websockets/ws/pull/2231
- https://github.com/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f
- https://github.com/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e
- https://github.com/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c
- https://github.com/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63
- https://github.com/advisories/GHSA-3h5v-q93c-6h6q",
          "reported_by": null,
          "severity": "high",
          "title": "ws affected by a DoS when handling a request with many HTTP headers",
          "updated": "2024-08-05T05:02:34.000Z",
          "url": "https://github.com/advisories/GHSA-3h5v-q93c-6h6q",
          "vulnerable_versions": ">=8.0.0 <8.17.1",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098392,
          "optional": false,
          "path": "jest-cli>jest-config>jest-environment-jsdom>jsdom>ws",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-06-17T19:09:10.000Z",
          "cves": Array [
            "CVE-2024-37890",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-476",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>ws",
              ],
              "version": "8.4.2",
            },
            Object {
              "paths": Array [
                "jest-cli>jest-config>jest-environment-jsdom>jsdom>ws",
                "jest>@jest/core>jest-config>jest-environment-jsdom>jsdom>ws",
                "jest>jest-cli>@jest/core>jest-config>jest-environment-jsdom>jsdom>ws",
                "jest>jest-cli>@jest/core>jest-config>jest-runner>jest-environment-jsdom>jsdom>ws",
              ],
              "version": "8.4.2",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-3h5v-q93c-6h6q",
          "id": 1098392,
          "metadata": null,
          "module_name": "ws",
          "npm_advisory_id": null,
          "overview": "### Impact

A request with a number of headers exceeding the[\`server.maxHeadersCount\`][] threshold could be used to crash a ws server.

### Proof of concept

\`\`\`js
const http = require('http');
const WebSocket = require('ws');

const wss = new WebSocket.Server({ port: 0 }, function () {
  const chars = \\"!#$%&'*+-.0123456789abcdefghijklmnopqrstuvwxyz^_\`|~\\".split('');
  const headers = {};
  let count = 0;

  for (let i = 0; i < chars.length; i++) {
    if (count === 2000) break;

    for (let j = 0; j < chars.length; j++) {
      const key = chars[i] + chars[j];
      headers[key] = 'x';

      if (++count === 2000) break;
    }
  }

  headers.Connection = 'Upgrade';
  headers.Upgrade = 'websocket';
  headers['Sec-WebSocket-Key'] = 'dGhlIHNhbXBsZSBub25jZQ==';
  headers['Sec-WebSocket-Version'] = '13';

  const request = http.request({
    headers: headers,
    host: '127.0.0.1',
    port: wss.address().port
  });

  request.end();
});
\`\`\`

### Patches

The vulnerability was fixed in ws@8.17.1 (https://github.com/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c) and backported to ws@7.5.10 (https://github.com/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f), ws@6.2.3 (https://github.com/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63), and ws@5.2.4 (https://github.com/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e)

### Workarounds

In vulnerable versions of ws, the issue can be mitigated in the following ways:

1. Reduce the maximum allowed length of the request headers using the [\`--max-http-header-size=size\`][] and/or the [\`maxHeaderSize\`][] options so that no more headers than the \`server.maxHeadersCount\` limit can be sent.
2. Set \`server.maxHeadersCount\` to \`0\` so that no limit is applied.

### Credits

The vulnerability was reported by [Ryan LaPointe](https://github.com/rrlapointe) in https://github.com/websockets/ws/issues/2230.

### References

- https://github.com/websockets/ws/issues/2230
- https://github.com/websockets/ws/pull/2231

[\`--max-http-header-size=size\`]: https://nodejs.org/api/cli.html#--max-http-header-sizesize
[\`maxHeaderSize\`]: https://nodejs.org/api/http.html#httpcreateserveroptions-requestlistener
[\`server.maxHeadersCount\`]: https://nodejs.org/api/http.html#servermaxheaderscount
",
          "patched_versions": ">=8.17.1",
          "recommendation": "Upgrade to version 8.17.1 or later",
          "references": "- https://github.com/websockets/ws/security/advisories/GHSA-3h5v-q93c-6h6q
- https://github.com/websockets/ws/issues/2230
- https://github.com/websockets/ws/pull/2231
- https://github.com/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f
- https://github.com/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e
- https://github.com/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c
- https://github.com/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63
- https://github.com/advisories/GHSA-3h5v-q93c-6h6q",
          "reported_by": null,
          "severity": "high",
          "title": "ws affected by a DoS when handling a request with many HTTP headers",
          "updated": "2024-08-05T05:02:34.000Z",
          "url": "https://github.com/advisories/GHSA-3h5v-q93c-6h6q",
          "vulnerable_versions": ">=8.0.0 <8.17.1",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098392,
          "optional": false,
          "path": "jest>@jest/core>jest-config>jest-environment-jsdom>jsdom>ws",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-06-17T19:09:10.000Z",
          "cves": Array [
            "CVE-2024-37890",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-476",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>ws",
              ],
              "version": "8.4.2",
            },
            Object {
              "paths": Array [
                "jest-cli>jest-config>jest-environment-jsdom>jsdom>ws",
                "jest>@jest/core>jest-config>jest-environment-jsdom>jsdom>ws",
                "jest>jest-cli>@jest/core>jest-config>jest-environment-jsdom>jsdom>ws",
                "jest>jest-cli>@jest/core>jest-config>jest-runner>jest-environment-jsdom>jsdom>ws",
              ],
              "version": "8.4.2",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-3h5v-q93c-6h6q",
          "id": 1098392,
          "metadata": null,
          "module_name": "ws",
          "npm_advisory_id": null,
          "overview": "### Impact

A request with a number of headers exceeding the[\`server.maxHeadersCount\`][] threshold could be used to crash a ws server.

### Proof of concept

\`\`\`js
const http = require('http');
const WebSocket = require('ws');

const wss = new WebSocket.Server({ port: 0 }, function () {
  const chars = \\"!#$%&'*+-.0123456789abcdefghijklmnopqrstuvwxyz^_\`|~\\".split('');
  const headers = {};
  let count = 0;

  for (let i = 0; i < chars.length; i++) {
    if (count === 2000) break;

    for (let j = 0; j < chars.length; j++) {
      const key = chars[i] + chars[j];
      headers[key] = 'x';

      if (++count === 2000) break;
    }
  }

  headers.Connection = 'Upgrade';
  headers.Upgrade = 'websocket';
  headers['Sec-WebSocket-Key'] = 'dGhlIHNhbXBsZSBub25jZQ==';
  headers['Sec-WebSocket-Version'] = '13';

  const request = http.request({
    headers: headers,
    host: '127.0.0.1',
    port: wss.address().port
  });

  request.end();
});
\`\`\`

### Patches

The vulnerability was fixed in ws@8.17.1 (https://github.com/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c) and backported to ws@7.5.10 (https://github.com/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f), ws@6.2.3 (https://github.com/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63), and ws@5.2.4 (https://github.com/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e)

### Workarounds

In vulnerable versions of ws, the issue can be mitigated in the following ways:

1. Reduce the maximum allowed length of the request headers using the [\`--max-http-header-size=size\`][] and/or the [\`maxHeaderSize\`][] options so that no more headers than the \`server.maxHeadersCount\` limit can be sent.
2. Set \`server.maxHeadersCount\` to \`0\` so that no limit is applied.

### Credits

The vulnerability was reported by [Ryan LaPointe](https://github.com/rrlapointe) in https://github.com/websockets/ws/issues/2230.

### References

- https://github.com/websockets/ws/issues/2230
- https://github.com/websockets/ws/pull/2231

[\`--max-http-header-size=size\`]: https://nodejs.org/api/cli.html#--max-http-header-sizesize
[\`maxHeaderSize\`]: https://nodejs.org/api/http.html#httpcreateserveroptions-requestlistener
[\`server.maxHeadersCount\`]: https://nodejs.org/api/http.html#servermaxheaderscount
",
          "patched_versions": ">=8.17.1",
          "recommendation": "Upgrade to version 8.17.1 or later",
          "references": "- https://github.com/websockets/ws/security/advisories/GHSA-3h5v-q93c-6h6q
- https://github.com/websockets/ws/issues/2230
- https://github.com/websockets/ws/pull/2231
- https://github.com/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f
- https://github.com/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e
- https://github.com/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c
- https://github.com/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63
- https://github.com/advisories/GHSA-3h5v-q93c-6h6q",
          "reported_by": null,
          "severity": "high",
          "title": "ws affected by a DoS when handling a request with many HTTP headers",
          "updated": "2024-08-05T05:02:34.000Z",
          "url": "https://github.com/advisories/GHSA-3h5v-q93c-6h6q",
          "vulnerable_versions": ">=8.0.0 <8.17.1",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098392,
          "optional": false,
          "path": "jest>jest-cli>@jest/core>jest-config>jest-environment-jsdom>jsdom>ws",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-06-17T19:09:10.000Z",
          "cves": Array [
            "CVE-2024-37890",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-476",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>ws",
              ],
              "version": "8.4.2",
            },
            Object {
              "paths": Array [
                "jest-cli>jest-config>jest-environment-jsdom>jsdom>ws",
                "jest>@jest/core>jest-config>jest-environment-jsdom>jsdom>ws",
                "jest>jest-cli>@jest/core>jest-config>jest-environment-jsdom>jsdom>ws",
                "jest>jest-cli>@jest/core>jest-config>jest-runner>jest-environment-jsdom>jsdom>ws",
              ],
              "version": "8.4.2",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-3h5v-q93c-6h6q",
          "id": 1098392,
          "metadata": null,
          "module_name": "ws",
          "npm_advisory_id": null,
          "overview": "### Impact

A request with a number of headers exceeding the[\`server.maxHeadersCount\`][] threshold could be used to crash a ws server.

### Proof of concept

\`\`\`js
const http = require('http');
const WebSocket = require('ws');

const wss = new WebSocket.Server({ port: 0 }, function () {
  const chars = \\"!#$%&'*+-.0123456789abcdefghijklmnopqrstuvwxyz^_\`|~\\".split('');
  const headers = {};
  let count = 0;

  for (let i = 0; i < chars.length; i++) {
    if (count === 2000) break;

    for (let j = 0; j < chars.length; j++) {
      const key = chars[i] + chars[j];
      headers[key] = 'x';

      if (++count === 2000) break;
    }
  }

  headers.Connection = 'Upgrade';
  headers.Upgrade = 'websocket';
  headers['Sec-WebSocket-Key'] = 'dGhlIHNhbXBsZSBub25jZQ==';
  headers['Sec-WebSocket-Version'] = '13';

  const request = http.request({
    headers: headers,
    host: '127.0.0.1',
    port: wss.address().port
  });

  request.end();
});
\`\`\`

### Patches

The vulnerability was fixed in ws@8.17.1 (https://github.com/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c) and backported to ws@7.5.10 (https://github.com/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f), ws@6.2.3 (https://github.com/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63), and ws@5.2.4 (https://github.com/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e)

### Workarounds

In vulnerable versions of ws, the issue can be mitigated in the following ways:

1. Reduce the maximum allowed length of the request headers using the [\`--max-http-header-size=size\`][] and/or the [\`maxHeaderSize\`][] options so that no more headers than the \`server.maxHeadersCount\` limit can be sent.
2. Set \`server.maxHeadersCount\` to \`0\` so that no limit is applied.

### Credits

The vulnerability was reported by [Ryan LaPointe](https://github.com/rrlapointe) in https://github.com/websockets/ws/issues/2230.

### References

- https://github.com/websockets/ws/issues/2230
- https://github.com/websockets/ws/pull/2231

[\`--max-http-header-size=size\`]: https://nodejs.org/api/cli.html#--max-http-header-sizesize
[\`maxHeaderSize\`]: https://nodejs.org/api/http.html#httpcreateserveroptions-requestlistener
[\`server.maxHeadersCount\`]: https://nodejs.org/api/http.html#servermaxheaderscount
",
          "patched_versions": ">=8.17.1",
          "recommendation": "Upgrade to version 8.17.1 or later",
          "references": "- https://github.com/websockets/ws/security/advisories/GHSA-3h5v-q93c-6h6q
- https://github.com/websockets/ws/issues/2230
- https://github.com/websockets/ws/pull/2231
- https://github.com/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f
- https://github.com/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e
- https://github.com/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c
- https://github.com/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63
- https://github.com/advisories/GHSA-3h5v-q93c-6h6q",
          "reported_by": null,
          "severity": "high",
          "title": "ws affected by a DoS when handling a request with many HTTP headers",
          "updated": "2024-08-05T05:02:34.000Z",
          "url": "https://github.com/advisories/GHSA-3h5v-q93c-6h6q",
          "vulnerable_versions": ">=8.0.0 <8.17.1",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098392,
          "optional": false,
          "path": "jest>jest-cli>@jest/core>jest-config>jest-runner>jest-environment-jsdom>jsdom>ws",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2023-06-21T06:30:28.000Z",
          "cves": Array [
            "CVE-2022-25883",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@commitlint/cli>@commitlint/lint>@commitlint/is-ignored>semver",
              ],
              "version": "7.3.2",
            },
            Object {
              "paths": Array [
                "lerna>@lerna/legacy-package-management>semver",
              ],
              "version": "7.3.8",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-c2qf-rxjj-qqgw",
          "id": 1098562,
          "metadata": null,
          "module_name": "semver",
          "npm_advisory_id": null,
          "overview": "Versions of the package semver before 7.5.2 on the 7.x branch, before 6.3.1 on the 6.x branch, and all other versions before 5.7.2 are vulnerable to Regular Expression Denial of Service (ReDoS) via the function new Range, when untrusted user data is provided as a range.",
          "patched_versions": ">=7.5.2",
          "recommendation": "Upgrade to version 7.5.2 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2022-25883
- https://github.com/npm/node-semver/pull/564
- https://github.com/npm/node-semver/commit/717534ee353682f3bcf33e60a8af4292626d4441
- https://security.snyk.io/vuln/SNYK-JS-SEMVER-3247795
- https://github.com/npm/node-semver/blob/main/classes/range.js#L97-L104
- https://github.com/npm/node-semver/blob/main/internal/re.js#L138
- https://github.com/npm/node-semver/blob/main/internal/re.js#L160
- https://github.com/npm/node-semver/pull/585
- https://github.com/npm/node-semver/commit/928e56d21150da0413a3333a3148b20e741a920c
- https://github.com/npm/node-semver/pull/593
- https://github.com/npm/node-semver/commit/2f8fd41487acf380194579ecb6f8b1bbfe116be0
- https://github.com/advisories/GHSA-c2qf-rxjj-qqgw",
          "reported_by": null,
          "severity": "high",
          "title": "semver vulnerable to Regular Expression Denial of Service",
          "updated": "2024-08-08T16:23:02.000Z",
          "url": "https://github.com/advisories/GHSA-c2qf-rxjj-qqgw",
          "vulnerable_versions": ">=7.0.0 <7.5.2",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098562,
          "optional": false,
          "path": "@commitlint/cli>@commitlint/lint>@commitlint/is-ignored>semver",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-03-22T16:57:05.000Z",
          "cves": Array [
            "CVE-2024-28863",
          ],
          "cvss": Object {
            "score": 6.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "lerna>tar",
                "lerna>pacote>tar",
                "lerna>@npmcli/run-script>node-gyp>tar",
                "lerna>pacote>@npmcli/run-script>node-gyp>tar",
                "lerna>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>terser-webpack-plugin>cacache>tar",
                "lerna>@lerna/create>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>sigstore>@sigstore/tuf>tuf-js>make-fetch-happen>cacache>tar",
              ],
              "version": "4.4.19",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-f5x3-32g6-xq36",
          "id": 1097493,
          "metadata": null,
          "module_name": "tar",
          "npm_advisory_id": null,
          "overview": "## Description: 
During some analysis today on npm's \`node-tar\` package I came across the folder creation process, Basicly if you provide node-tar with a path like this \`./a/b/c/foo.txt\` it would create every folder and sub-folder here a, b and c until it reaches the last folder to create \`foo.txt\`, In-this case I noticed that there's no validation at all on the amount of folders being created, that said we're actually able to CPU and memory consume the system running node-tar and even crash the nodejs client within few seconds of running it using a path with too many sub-folders inside

## Steps To Reproduce:
You can reproduce this issue by downloading the tar file I provided in the resources and using node-tar to extract it, you should get the same behavior as the video

## Proof Of Concept:
Here's a [video](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3i7uojw8s52psar6pg8zkdo4h9io?response-content-disposition=attachment%3B%20filename%3D%22tar-dos-poc.webm%22%3B%20filename%2A%3DUTF-8%27%27tar-dos-poc.webm&response-content-type=video%2Fwebm&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1e8235d885f1d61529b7d6b23ea3a0780c300c91d86e925dd8310d5b661ddbe2) show-casing the exploit: 

## Impact

Denial of service by crashing the nodejs client when attempting to parse a tar archive, make it run out of heap memory and consuming server CPU and memory resources

## Report resources
[payload.txt](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1e83ayb5dd3350fvj3gst0mqixwk?response-content-disposition=attachment%3B%20filename%3D%22payload.txt%22%3B%20filename%2A%3DUTF-8%27%27payload.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bad9fe731f05a63a950f99828125653a8c1254750fe0ca7be882e89ecdd449ae)
[archeive.tar.gz](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ymkuh4xnfdcf1soeyi7jc2x4yt2i?response-content-disposition=attachment%3B%20filename%3D%22archive.tar.gz%22%3B%20filename%2A%3DUTF-8%27%27archive.tar.gz&response-content-type=application%2Fx-tar&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5e2c0d4b4de40373ac0fe91908c2659141a6dd4ab850271cc26042a3885c82ea)

## Note
This report was originally reported to GitHub bug bounty program, they asked me to report it to you a month ago",
          "patched_versions": ">=6.2.1",
          "recommendation": "Upgrade to version 6.2.1 or later",
          "references": "- https://github.com/isaacs/node-tar/security/advisories/GHSA-f5x3-32g6-xq36
- https://nvd.nist.gov/vuln/detail/CVE-2024-28863
- https://github.com/isaacs/node-tar/commit/fe8cd57da5686f8695415414bda49206a545f7f7
- https://security.netapp.com/advisory/ntap-20240524-0005
- https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "reported_by": null,
          "severity": "moderate",
          "title": "Denial of service while parsing a tar file due to lack of folders count validation",
          "updated": "2024-06-10T18:30:53.000Z",
          "url": "https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "vulnerable_versions": "<6.2.1",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1097493,
          "optional": false,
          "path": "lerna>pacote>tar",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-03-22T16:57:05.000Z",
          "cves": Array [
            "CVE-2024-28863",
          ],
          "cvss": Object {
            "score": 6.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "lerna>tar",
                "lerna>pacote>tar",
                "lerna>@npmcli/run-script>node-gyp>tar",
                "lerna>pacote>@npmcli/run-script>node-gyp>tar",
                "lerna>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>terser-webpack-plugin>cacache>tar",
                "lerna>@lerna/create>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>sigstore>@sigstore/tuf>tuf-js>make-fetch-happen>cacache>tar",
              ],
              "version": "4.4.19",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-f5x3-32g6-xq36",
          "id": 1097493,
          "metadata": null,
          "module_name": "tar",
          "npm_advisory_id": null,
          "overview": "## Description: 
During some analysis today on npm's \`node-tar\` package I came across the folder creation process, Basicly if you provide node-tar with a path like this \`./a/b/c/foo.txt\` it would create every folder and sub-folder here a, b and c until it reaches the last folder to create \`foo.txt\`, In-this case I noticed that there's no validation at all on the amount of folders being created, that said we're actually able to CPU and memory consume the system running node-tar and even crash the nodejs client within few seconds of running it using a path with too many sub-folders inside

## Steps To Reproduce:
You can reproduce this issue by downloading the tar file I provided in the resources and using node-tar to extract it, you should get the same behavior as the video

## Proof Of Concept:
Here's a [video](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3i7uojw8s52psar6pg8zkdo4h9io?response-content-disposition=attachment%3B%20filename%3D%22tar-dos-poc.webm%22%3B%20filename%2A%3DUTF-8%27%27tar-dos-poc.webm&response-content-type=video%2Fwebm&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1e8235d885f1d61529b7d6b23ea3a0780c300c91d86e925dd8310d5b661ddbe2) show-casing the exploit: 

## Impact

Denial of service by crashing the nodejs client when attempting to parse a tar archive, make it run out of heap memory and consuming server CPU and memory resources

## Report resources
[payload.txt](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1e83ayb5dd3350fvj3gst0mqixwk?response-content-disposition=attachment%3B%20filename%3D%22payload.txt%22%3B%20filename%2A%3DUTF-8%27%27payload.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bad9fe731f05a63a950f99828125653a8c1254750fe0ca7be882e89ecdd449ae)
[archeive.tar.gz](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ymkuh4xnfdcf1soeyi7jc2x4yt2i?response-content-disposition=attachment%3B%20filename%3D%22archive.tar.gz%22%3B%20filename%2A%3DUTF-8%27%27archive.tar.gz&response-content-type=application%2Fx-tar&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5e2c0d4b4de40373ac0fe91908c2659141a6dd4ab850271cc26042a3885c82ea)

## Note
This report was originally reported to GitHub bug bounty program, they asked me to report it to you a month ago",
          "patched_versions": ">=6.2.1",
          "recommendation": "Upgrade to version 6.2.1 or later",
          "references": "- https://github.com/isaacs/node-tar/security/advisories/GHSA-f5x3-32g6-xq36
- https://nvd.nist.gov/vuln/detail/CVE-2024-28863
- https://github.com/isaacs/node-tar/commit/fe8cd57da5686f8695415414bda49206a545f7f7
- https://security.netapp.com/advisory/ntap-20240524-0005
- https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "reported_by": null,
          "severity": "moderate",
          "title": "Denial of service while parsing a tar file due to lack of folders count validation",
          "updated": "2024-06-10T18:30:53.000Z",
          "url": "https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "vulnerable_versions": "<6.2.1",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1097493,
          "optional": false,
          "path": "lerna>@npmcli/run-script>node-gyp>tar",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-03-22T16:57:05.000Z",
          "cves": Array [
            "CVE-2024-28863",
          ],
          "cvss": Object {
            "score": 6.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "lerna>tar",
                "lerna>pacote>tar",
                "lerna>@npmcli/run-script>node-gyp>tar",
                "lerna>pacote>@npmcli/run-script>node-gyp>tar",
                "lerna>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>terser-webpack-plugin>cacache>tar",
                "lerna>@lerna/create>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>sigstore>@sigstore/tuf>tuf-js>make-fetch-happen>cacache>tar",
              ],
              "version": "4.4.19",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-f5x3-32g6-xq36",
          "id": 1097493,
          "metadata": null,
          "module_name": "tar",
          "npm_advisory_id": null,
          "overview": "## Description: 
During some analysis today on npm's \`node-tar\` package I came across the folder creation process, Basicly if you provide node-tar with a path like this \`./a/b/c/foo.txt\` it would create every folder and sub-folder here a, b and c until it reaches the last folder to create \`foo.txt\`, In-this case I noticed that there's no validation at all on the amount of folders being created, that said we're actually able to CPU and memory consume the system running node-tar and even crash the nodejs client within few seconds of running it using a path with too many sub-folders inside

## Steps To Reproduce:
You can reproduce this issue by downloading the tar file I provided in the resources and using node-tar to extract it, you should get the same behavior as the video

## Proof Of Concept:
Here's a [video](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3i7uojw8s52psar6pg8zkdo4h9io?response-content-disposition=attachment%3B%20filename%3D%22tar-dos-poc.webm%22%3B%20filename%2A%3DUTF-8%27%27tar-dos-poc.webm&response-content-type=video%2Fwebm&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1e8235d885f1d61529b7d6b23ea3a0780c300c91d86e925dd8310d5b661ddbe2) show-casing the exploit: 

## Impact

Denial of service by crashing the nodejs client when attempting to parse a tar archive, make it run out of heap memory and consuming server CPU and memory resources

## Report resources
[payload.txt](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1e83ayb5dd3350fvj3gst0mqixwk?response-content-disposition=attachment%3B%20filename%3D%22payload.txt%22%3B%20filename%2A%3DUTF-8%27%27payload.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bad9fe731f05a63a950f99828125653a8c1254750fe0ca7be882e89ecdd449ae)
[archeive.tar.gz](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ymkuh4xnfdcf1soeyi7jc2x4yt2i?response-content-disposition=attachment%3B%20filename%3D%22archive.tar.gz%22%3B%20filename%2A%3DUTF-8%27%27archive.tar.gz&response-content-type=application%2Fx-tar&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5e2c0d4b4de40373ac0fe91908c2659141a6dd4ab850271cc26042a3885c82ea)

## Note
This report was originally reported to GitHub bug bounty program, they asked me to report it to you a month ago",
          "patched_versions": ">=6.2.1",
          "recommendation": "Upgrade to version 6.2.1 or later",
          "references": "- https://github.com/isaacs/node-tar/security/advisories/GHSA-f5x3-32g6-xq36
- https://nvd.nist.gov/vuln/detail/CVE-2024-28863
- https://github.com/isaacs/node-tar/commit/fe8cd57da5686f8695415414bda49206a545f7f7
- https://security.netapp.com/advisory/ntap-20240524-0005
- https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "reported_by": null,
          "severity": "moderate",
          "title": "Denial of service while parsing a tar file due to lack of folders count validation",
          "updated": "2024-06-10T18:30:53.000Z",
          "url": "https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "vulnerable_versions": "<6.2.1",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1097493,
          "optional": false,
          "path": "lerna>pacote>@npmcli/run-script>node-gyp>tar",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-03-22T16:57:05.000Z",
          "cves": Array [
            "CVE-2024-28863",
          ],
          "cvss": Object {
            "score": 6.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "lerna>tar",
                "lerna>pacote>tar",
                "lerna>@npmcli/run-script>node-gyp>tar",
                "lerna>pacote>@npmcli/run-script>node-gyp>tar",
                "lerna>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>terser-webpack-plugin>cacache>tar",
                "lerna>@lerna/create>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>sigstore>@sigstore/tuf>tuf-js>make-fetch-happen>cacache>tar",
              ],
              "version": "4.4.19",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-f5x3-32g6-xq36",
          "id": 1097493,
          "metadata": null,
          "module_name": "tar",
          "npm_advisory_id": null,
          "overview": "## Description: 
During some analysis today on npm's \`node-tar\` package I came across the folder creation process, Basicly if you provide node-tar with a path like this \`./a/b/c/foo.txt\` it would create every folder and sub-folder here a, b and c until it reaches the last folder to create \`foo.txt\`, In-this case I noticed that there's no validation at all on the amount of folders being created, that said we're actually able to CPU and memory consume the system running node-tar and even crash the nodejs client within few seconds of running it using a path with too many sub-folders inside

## Steps To Reproduce:
You can reproduce this issue by downloading the tar file I provided in the resources and using node-tar to extract it, you should get the same behavior as the video

## Proof Of Concept:
Here's a [video](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3i7uojw8s52psar6pg8zkdo4h9io?response-content-disposition=attachment%3B%20filename%3D%22tar-dos-poc.webm%22%3B%20filename%2A%3DUTF-8%27%27tar-dos-poc.webm&response-content-type=video%2Fwebm&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1e8235d885f1d61529b7d6b23ea3a0780c300c91d86e925dd8310d5b661ddbe2) show-casing the exploit: 

## Impact

Denial of service by crashing the nodejs client when attempting to parse a tar archive, make it run out of heap memory and consuming server CPU and memory resources

## Report resources
[payload.txt](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1e83ayb5dd3350fvj3gst0mqixwk?response-content-disposition=attachment%3B%20filename%3D%22payload.txt%22%3B%20filename%2A%3DUTF-8%27%27payload.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bad9fe731f05a63a950f99828125653a8c1254750fe0ca7be882e89ecdd449ae)
[archeive.tar.gz](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ymkuh4xnfdcf1soeyi7jc2x4yt2i?response-content-disposition=attachment%3B%20filename%3D%22archive.tar.gz%22%3B%20filename%2A%3DUTF-8%27%27archive.tar.gz&response-content-type=application%2Fx-tar&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5e2c0d4b4de40373ac0fe91908c2659141a6dd4ab850271cc26042a3885c82ea)

## Note
This report was originally reported to GitHub bug bounty program, they asked me to report it to you a month ago",
          "patched_versions": ">=6.2.1",
          "recommendation": "Upgrade to version 6.2.1 or later",
          "references": "- https://github.com/isaacs/node-tar/security/advisories/GHSA-f5x3-32g6-xq36
- https://nvd.nist.gov/vuln/detail/CVE-2024-28863
- https://github.com/isaacs/node-tar/commit/fe8cd57da5686f8695415414bda49206a545f7f7
- https://security.netapp.com/advisory/ntap-20240524-0005
- https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "reported_by": null,
          "severity": "moderate",
          "title": "Denial of service while parsing a tar file due to lack of folders count validation",
          "updated": "2024-06-10T18:30:53.000Z",
          "url": "https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "vulnerable_versions": "<6.2.1",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1097493,
          "optional": false,
          "path": "lerna>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-03-22T16:57:05.000Z",
          "cves": Array [
            "CVE-2024-28863",
          ],
          "cvss": Object {
            "score": 6.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "lerna>tar",
                "lerna>pacote>tar",
                "lerna>@npmcli/run-script>node-gyp>tar",
                "lerna>pacote>@npmcli/run-script>node-gyp>tar",
                "lerna>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>terser-webpack-plugin>cacache>tar",
                "lerna>@lerna/create>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>sigstore>@sigstore/tuf>tuf-js>make-fetch-happen>cacache>tar",
              ],
              "version": "4.4.19",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-f5x3-32g6-xq36",
          "id": 1097493,
          "metadata": null,
          "module_name": "tar",
          "npm_advisory_id": null,
          "overview": "## Description: 
During some analysis today on npm's \`node-tar\` package I came across the folder creation process, Basicly if you provide node-tar with a path like this \`./a/b/c/foo.txt\` it would create every folder and sub-folder here a, b and c until it reaches the last folder to create \`foo.txt\`, In-this case I noticed that there's no validation at all on the amount of folders being created, that said we're actually able to CPU and memory consume the system running node-tar and even crash the nodejs client within few seconds of running it using a path with too many sub-folders inside

## Steps To Reproduce:
You can reproduce this issue by downloading the tar file I provided in the resources and using node-tar to extract it, you should get the same behavior as the video

## Proof Of Concept:
Here's a [video](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3i7uojw8s52psar6pg8zkdo4h9io?response-content-disposition=attachment%3B%20filename%3D%22tar-dos-poc.webm%22%3B%20filename%2A%3DUTF-8%27%27tar-dos-poc.webm&response-content-type=video%2Fwebm&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1e8235d885f1d61529b7d6b23ea3a0780c300c91d86e925dd8310d5b661ddbe2) show-casing the exploit: 

## Impact

Denial of service by crashing the nodejs client when attempting to parse a tar archive, make it run out of heap memory and consuming server CPU and memory resources

## Report resources
[payload.txt](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1e83ayb5dd3350fvj3gst0mqixwk?response-content-disposition=attachment%3B%20filename%3D%22payload.txt%22%3B%20filename%2A%3DUTF-8%27%27payload.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bad9fe731f05a63a950f99828125653a8c1254750fe0ca7be882e89ecdd449ae)
[archeive.tar.gz](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ymkuh4xnfdcf1soeyi7jc2x4yt2i?response-content-disposition=attachment%3B%20filename%3D%22archive.tar.gz%22%3B%20filename%2A%3DUTF-8%27%27archive.tar.gz&response-content-type=application%2Fx-tar&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5e2c0d4b4de40373ac0fe91908c2659141a6dd4ab850271cc26042a3885c82ea)

## Note
This report was originally reported to GitHub bug bounty program, they asked me to report it to you a month ago",
          "patched_versions": ">=6.2.1",
          "recommendation": "Upgrade to version 6.2.1 or later",
          "references": "- https://github.com/isaacs/node-tar/security/advisories/GHSA-f5x3-32g6-xq36
- https://nvd.nist.gov/vuln/detail/CVE-2024-28863
- https://github.com/isaacs/node-tar/commit/fe8cd57da5686f8695415414bda49206a545f7f7
- https://security.netapp.com/advisory/ntap-20240524-0005
- https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "reported_by": null,
          "severity": "moderate",
          "title": "Denial of service while parsing a tar file due to lack of folders count validation",
          "updated": "2024-06-10T18:30:53.000Z",
          "url": "https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "vulnerable_versions": "<6.2.1",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1097493,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>terser-webpack-plugin>cacache>tar",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-03-22T16:57:05.000Z",
          "cves": Array [
            "CVE-2024-28863",
          ],
          "cvss": Object {
            "score": 6.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "lerna>tar",
                "lerna>pacote>tar",
                "lerna>@npmcli/run-script>node-gyp>tar",
                "lerna>pacote>@npmcli/run-script>node-gyp>tar",
                "lerna>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>terser-webpack-plugin>cacache>tar",
                "lerna>@lerna/create>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>sigstore>@sigstore/tuf>tuf-js>make-fetch-happen>cacache>tar",
              ],
              "version": "4.4.19",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-f5x3-32g6-xq36",
          "id": 1097493,
          "metadata": null,
          "module_name": "tar",
          "npm_advisory_id": null,
          "overview": "## Description: 
During some analysis today on npm's \`node-tar\` package I came across the folder creation process, Basicly if you provide node-tar with a path like this \`./a/b/c/foo.txt\` it would create every folder and sub-folder here a, b and c until it reaches the last folder to create \`foo.txt\`, In-this case I noticed that there's no validation at all on the amount of folders being created, that said we're actually able to CPU and memory consume the system running node-tar and even crash the nodejs client within few seconds of running it using a path with too many sub-folders inside

## Steps To Reproduce:
You can reproduce this issue by downloading the tar file I provided in the resources and using node-tar to extract it, you should get the same behavior as the video

## Proof Of Concept:
Here's a [video](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3i7uojw8s52psar6pg8zkdo4h9io?response-content-disposition=attachment%3B%20filename%3D%22tar-dos-poc.webm%22%3B%20filename%2A%3DUTF-8%27%27tar-dos-poc.webm&response-content-type=video%2Fwebm&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1e8235d885f1d61529b7d6b23ea3a0780c300c91d86e925dd8310d5b661ddbe2) show-casing the exploit: 

## Impact

Denial of service by crashing the nodejs client when attempting to parse a tar archive, make it run out of heap memory and consuming server CPU and memory resources

## Report resources
[payload.txt](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1e83ayb5dd3350fvj3gst0mqixwk?response-content-disposition=attachment%3B%20filename%3D%22payload.txt%22%3B%20filename%2A%3DUTF-8%27%27payload.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bad9fe731f05a63a950f99828125653a8c1254750fe0ca7be882e89ecdd449ae)
[archeive.tar.gz](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ymkuh4xnfdcf1soeyi7jc2x4yt2i?response-content-disposition=attachment%3B%20filename%3D%22archive.tar.gz%22%3B%20filename%2A%3DUTF-8%27%27archive.tar.gz&response-content-type=application%2Fx-tar&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5e2c0d4b4de40373ac0fe91908c2659141a6dd4ab850271cc26042a3885c82ea)

## Note
This report was originally reported to GitHub bug bounty program, they asked me to report it to you a month ago",
          "patched_versions": ">=6.2.1",
          "recommendation": "Upgrade to version 6.2.1 or later",
          "references": "- https://github.com/isaacs/node-tar/security/advisories/GHSA-f5x3-32g6-xq36
- https://nvd.nist.gov/vuln/detail/CVE-2024-28863
- https://github.com/isaacs/node-tar/commit/fe8cd57da5686f8695415414bda49206a545f7f7
- https://security.netapp.com/advisory/ntap-20240524-0005
- https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "reported_by": null,
          "severity": "moderate",
          "title": "Denial of service while parsing a tar file due to lack of folders count validation",
          "updated": "2024-06-10T18:30:53.000Z",
          "url": "https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "vulnerable_versions": "<6.2.1",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1097493,
          "optional": false,
          "path": "lerna>@lerna/create>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-03-22T16:57:05.000Z",
          "cves": Array [
            "CVE-2024-28863",
          ],
          "cvss": Object {
            "score": 6.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "lerna>tar",
                "lerna>pacote>tar",
                "lerna>@npmcli/run-script>node-gyp>tar",
                "lerna>pacote>@npmcli/run-script>node-gyp>tar",
                "lerna>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>terser-webpack-plugin>cacache>tar",
                "lerna>@lerna/create>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>sigstore>@sigstore/tuf>tuf-js>make-fetch-happen>cacache>tar",
              ],
              "version": "4.4.19",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-f5x3-32g6-xq36",
          "id": 1097493,
          "metadata": null,
          "module_name": "tar",
          "npm_advisory_id": null,
          "overview": "## Description: 
During some analysis today on npm's \`node-tar\` package I came across the folder creation process, Basicly if you provide node-tar with a path like this \`./a/b/c/foo.txt\` it would create every folder and sub-folder here a, b and c until it reaches the last folder to create \`foo.txt\`, In-this case I noticed that there's no validation at all on the amount of folders being created, that said we're actually able to CPU and memory consume the system running node-tar and even crash the nodejs client within few seconds of running it using a path with too many sub-folders inside

## Steps To Reproduce:
You can reproduce this issue by downloading the tar file I provided in the resources and using node-tar to extract it, you should get the same behavior as the video

## Proof Of Concept:
Here's a [video](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3i7uojw8s52psar6pg8zkdo4h9io?response-content-disposition=attachment%3B%20filename%3D%22tar-dos-poc.webm%22%3B%20filename%2A%3DUTF-8%27%27tar-dos-poc.webm&response-content-type=video%2Fwebm&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1e8235d885f1d61529b7d6b23ea3a0780c300c91d86e925dd8310d5b661ddbe2) show-casing the exploit: 

## Impact

Denial of service by crashing the nodejs client when attempting to parse a tar archive, make it run out of heap memory and consuming server CPU and memory resources

## Report resources
[payload.txt](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1e83ayb5dd3350fvj3gst0mqixwk?response-content-disposition=attachment%3B%20filename%3D%22payload.txt%22%3B%20filename%2A%3DUTF-8%27%27payload.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bad9fe731f05a63a950f99828125653a8c1254750fe0ca7be882e89ecdd449ae)
[archeive.tar.gz](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ymkuh4xnfdcf1soeyi7jc2x4yt2i?response-content-disposition=attachment%3B%20filename%3D%22archive.tar.gz%22%3B%20filename%2A%3DUTF-8%27%27archive.tar.gz&response-content-type=application%2Fx-tar&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5e2c0d4b4de40373ac0fe91908c2659141a6dd4ab850271cc26042a3885c82ea)

## Note
This report was originally reported to GitHub bug bounty program, they asked me to report it to you a month ago",
          "patched_versions": ">=6.2.1",
          "recommendation": "Upgrade to version 6.2.1 or later",
          "references": "- https://github.com/isaacs/node-tar/security/advisories/GHSA-f5x3-32g6-xq36
- https://nvd.nist.gov/vuln/detail/CVE-2024-28863
- https://github.com/isaacs/node-tar/commit/fe8cd57da5686f8695415414bda49206a545f7f7
- https://security.netapp.com/advisory/ntap-20240524-0005
- https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "reported_by": null,
          "severity": "moderate",
          "title": "Denial of service while parsing a tar file due to lack of folders count validation",
          "updated": "2024-06-10T18:30:53.000Z",
          "url": "https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "vulnerable_versions": "<6.2.1",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1097493,
          "optional": false,
          "path": "lerna>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-03-22T16:57:05.000Z",
          "cves": Array [
            "CVE-2024-28863",
          ],
          "cvss": Object {
            "score": 6.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "lerna>tar",
                "lerna>pacote>tar",
                "lerna>@npmcli/run-script>node-gyp>tar",
                "lerna>pacote>@npmcli/run-script>node-gyp>tar",
                "lerna>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>terser-webpack-plugin>cacache>tar",
                "lerna>@lerna/create>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>sigstore>@sigstore/tuf>tuf-js>make-fetch-happen>cacache>tar",
              ],
              "version": "4.4.19",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-f5x3-32g6-xq36",
          "id": 1097493,
          "metadata": null,
          "module_name": "tar",
          "npm_advisory_id": null,
          "overview": "## Description: 
During some analysis today on npm's \`node-tar\` package I came across the folder creation process, Basicly if you provide node-tar with a path like this \`./a/b/c/foo.txt\` it would create every folder and sub-folder here a, b and c until it reaches the last folder to create \`foo.txt\`, In-this case I noticed that there's no validation at all on the amount of folders being created, that said we're actually able to CPU and memory consume the system running node-tar and even crash the nodejs client within few seconds of running it using a path with too many sub-folders inside

## Steps To Reproduce:
You can reproduce this issue by downloading the tar file I provided in the resources and using node-tar to extract it, you should get the same behavior as the video

## Proof Of Concept:
Here's a [video](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3i7uojw8s52psar6pg8zkdo4h9io?response-content-disposition=attachment%3B%20filename%3D%22tar-dos-poc.webm%22%3B%20filename%2A%3DUTF-8%27%27tar-dos-poc.webm&response-content-type=video%2Fwebm&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1e8235d885f1d61529b7d6b23ea3a0780c300c91d86e925dd8310d5b661ddbe2) show-casing the exploit: 

## Impact

Denial of service by crashing the nodejs client when attempting to parse a tar archive, make it run out of heap memory and consuming server CPU and memory resources

## Report resources
[payload.txt](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1e83ayb5dd3350fvj3gst0mqixwk?response-content-disposition=attachment%3B%20filename%3D%22payload.txt%22%3B%20filename%2A%3DUTF-8%27%27payload.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bad9fe731f05a63a950f99828125653a8c1254750fe0ca7be882e89ecdd449ae)
[archeive.tar.gz](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ymkuh4xnfdcf1soeyi7jc2x4yt2i?response-content-disposition=attachment%3B%20filename%3D%22archive.tar.gz%22%3B%20filename%2A%3DUTF-8%27%27archive.tar.gz&response-content-type=application%2Fx-tar&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5e2c0d4b4de40373ac0fe91908c2659141a6dd4ab850271cc26042a3885c82ea)

## Note
This report was originally reported to GitHub bug bounty program, they asked me to report it to you a month ago",
          "patched_versions": ">=6.2.1",
          "recommendation": "Upgrade to version 6.2.1 or later",
          "references": "- https://github.com/isaacs/node-tar/security/advisories/GHSA-f5x3-32g6-xq36
- https://nvd.nist.gov/vuln/detail/CVE-2024-28863
- https://github.com/isaacs/node-tar/commit/fe8cd57da5686f8695415414bda49206a545f7f7
- https://security.netapp.com/advisory/ntap-20240524-0005
- https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "reported_by": null,
          "severity": "moderate",
          "title": "Denial of service while parsing a tar file due to lack of folders count validation",
          "updated": "2024-06-10T18:30:53.000Z",
          "url": "https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "vulnerable_versions": "<6.2.1",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1097493,
          "optional": false,
          "path": "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-03-22T16:57:05.000Z",
          "cves": Array [
            "CVE-2024-28863",
          ],
          "cvss": Object {
            "score": 6.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "lerna>tar",
                "lerna>pacote>tar",
                "lerna>@npmcli/run-script>node-gyp>tar",
                "lerna>pacote>@npmcli/run-script>node-gyp>tar",
                "lerna>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>terser-webpack-plugin>cacache>tar",
                "lerna>@lerna/create>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>@npmcli/run-script>node-gyp>make-fetch-happen>cacache>tar",
                "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>sigstore>@sigstore/tuf>tuf-js>make-fetch-happen>cacache>tar",
              ],
              "version": "4.4.19",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-f5x3-32g6-xq36",
          "id": 1097493,
          "metadata": null,
          "module_name": "tar",
          "npm_advisory_id": null,
          "overview": "## Description: 
During some analysis today on npm's \`node-tar\` package I came across the folder creation process, Basicly if you provide node-tar with a path like this \`./a/b/c/foo.txt\` it would create every folder and sub-folder here a, b and c until it reaches the last folder to create \`foo.txt\`, In-this case I noticed that there's no validation at all on the amount of folders being created, that said we're actually able to CPU and memory consume the system running node-tar and even crash the nodejs client within few seconds of running it using a path with too many sub-folders inside

## Steps To Reproduce:
You can reproduce this issue by downloading the tar file I provided in the resources and using node-tar to extract it, you should get the same behavior as the video

## Proof Of Concept:
Here's a [video](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3i7uojw8s52psar6pg8zkdo4h9io?response-content-disposition=attachment%3B%20filename%3D%22tar-dos-poc.webm%22%3B%20filename%2A%3DUTF-8%27%27tar-dos-poc.webm&response-content-type=video%2Fwebm&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1e8235d885f1d61529b7d6b23ea3a0780c300c91d86e925dd8310d5b661ddbe2) show-casing the exploit: 

## Impact

Denial of service by crashing the nodejs client when attempting to parse a tar archive, make it run out of heap memory and consuming server CPU and memory resources

## Report resources
[payload.txt](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1e83ayb5dd3350fvj3gst0mqixwk?response-content-disposition=attachment%3B%20filename%3D%22payload.txt%22%3B%20filename%2A%3DUTF-8%27%27payload.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bad9fe731f05a63a950f99828125653a8c1254750fe0ca7be882e89ecdd449ae)
[archeive.tar.gz](https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ymkuh4xnfdcf1soeyi7jc2x4yt2i?response-content-disposition=attachment%3B%20filename%3D%22archive.tar.gz%22%3B%20filename%2A%3DUTF-8%27%27archive.tar.gz&response-content-type=application%2Fx-tar&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSWWGDXHA%2F20240312%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240312T080103Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEDcaCXVzLXdlc3QtMiJHMEUCID3xYDc6emXVPOg8iVR5dVk0u3gguTPIDJ0OIE%2BKxj17AiEAi%2BGiay1gGMWhH%2F031fvMYnSsa8U7CnpZpxvFAYqNRwgqsQUIQBADGgwwMTM2MTkyNzQ4NDkiDAaj6OgUL3gg4hhLLCqOBUUrOgWSqaK%2FmxN6nKRvB4Who3LIyzswFKm9LV94GiSVFP3zXYA480voCmAHTg7eBL7%2BrYgV2RtXbhF4aCFMCN3qu7GeXkIdH7xwVMi9zXHkekviSKZ%2FsZtVVjn7RFqOCKhJl%2FCoiLQJuDuju%2FtfdTGZbEbGsPgKHoILYbRp81K51zeRL21okjsOehmypkZzq%2BoGrXIX0ynPOKujxw27uqdF4T%2BF9ynodq01vGgwgVBEjHojc4OKOfr1oW5b%2FtGVV59%2BOBVI1hqIKHRG0Ed4SWmp%2BLd1hazGuZPvp52szmegnOj5qr3ubppnKL242bX%2FuAnQKzKK0HpwolqXjsuEeFeM85lxhqHV%2B1BJqaqSHHDa0HUMLZistMRshRlntuchcFQCR6HBa2c8PSnhpVC31zMzvYMfKsI12h4HB6l%2FudrmNrvmH4LmNpi4dZFcio21DzKj%2FRjWmxjH7l8egDyG%2FIgPMY6Ls4IiN7aR1jijYTrBCgPUUHets3BFvqLzHtPFnG3B7%2FYRPnhCLu%2FgzvKN3F8l38KqeTNMHJaxkuhCvEjpFB2SJbi2QZqZZbLj3xASqXoogzbsyPp0Tzp0tH7EKDhPA7H6wwiZukXfFhhlYzP8on9fO2Ajz%2F%2BTDkDjbfWw4KNJ0cFeDsGrUspqQZb5TAKlUge7iOZEc2TZ5uagatSy9Mg08E4nImBSE5QUHDc7Daya1gyqrETMDZBBUHH2RFkGA9qMpEtNrtJ9G%2BPedz%2FpPY1hh9OCp9Pg1BrX97l3SfVzlAMRfNibhywq6qnE35rVnZi%2BEQ1UgBjs9jD%2FQrW49%2FaD0oUDojVeuFFryzRnQxDbKtYgonRcItTvLT5Y0xaK9P0u6H1197%2FMk3XxmjD9%2Fb%2BvBjqxAQWWkKiIxpC1oHEWK9Jt8UdJ39xszDBGpBqjB6Tvt5ePAXSyX8np%2FrBi%2BAPx06O0%2Ba7pU4NmH800EVXxxhgfj9nMw3CeoUIdxorVKtU2Mxw%2FLaAiPgxPS4rqkt65NF7eQYfegcSYDTm2Z%2BHPbz9HfCaVZ28Zqeko6sR%2F29ML4bguqVvHAM4mWPLNDXH33mjG%2BuzLi8e1BF7tNveg2X9G%2FRdcMkojwKYbu6xN3M6aX2alQg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5e2c0d4b4de40373ac0fe91908c2659141a6dd4ab850271cc26042a3885c82ea)

## Note
This report was originally reported to GitHub bug bounty program, they asked me to report it to you a month ago",
          "patched_versions": ">=6.2.1",
          "recommendation": "Upgrade to version 6.2.1 or later",
          "references": "- https://github.com/isaacs/node-tar/security/advisories/GHSA-f5x3-32g6-xq36
- https://nvd.nist.gov/vuln/detail/CVE-2024-28863
- https://github.com/isaacs/node-tar/commit/fe8cd57da5686f8695415414bda49206a545f7f7
- https://security.netapp.com/advisory/ntap-20240524-0005
- https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "reported_by": null,
          "severity": "moderate",
          "title": "Denial of service while parsing a tar file due to lack of folders count validation",
          "updated": "2024-06-10T18:30:53.000Z",
          "url": "https://github.com/advisories/GHSA-f5x3-32g6-xq36",
          "vulnerable_versions": "<6.2.1",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1097493,
          "optional": false,
          "path": "lerna>@lerna/legacy-package-management>@npmcli/arborist>@npmcli/metavuln-calculator>pacote>sigstore>@sigstore/tuf>tuf-js>make-fetch-happen>cacache>tar",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4068",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-400",
            "CWE-1050",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch>braces",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch>braces",
              ],
              "version": "2.3.2",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-grv7-fg5c-xmjg",
          "id": 1098094,
          "metadata": null,
          "module_name": "braces",
          "npm_advisory_id": null,
          "overview": "The NPM package \`braces\` fails to limit the number of characters it can handle, which could lead to Memory Exhaustion. In \`lib/parse.js,\` if a malicious user sends \\"imbalanced braces\\" as input, the parsing will enter a loop, which will cause the program to start allocating heap memory without freeing it at any moment of the loop. Eventually, the JavaScript heap limit is reached, and the program will crash.
",
          "patched_versions": ">=3.0.3",
          "recommendation": "Upgrade to version 3.0.3 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4068
- https://github.com/micromatch/braces/issues/35
- https://devhub.checkmarx.com/cve-details/CVE-2024-4068
- https://github.com/micromatch/braces/blob/98414f9f1fabe021736e26836d8306d5de747e0d/lib/parse.js#L308
- https://github.com/micromatch/braces/pull/37
- https://github.com/micromatch/braces/pull/40
- https://github.com/micromatch/braces/commit/415d660c3002d1ab7e63dbf490c9851da80596ff
- https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "reported_by": null,
          "severity": "high",
          "title": "Uncontrolled resource consumption in braces",
          "updated": "2024-07-05T21:25:08.000Z",
          "url": "https://github.com/advisories/GHSA-grv7-fg5c-xmjg",
          "vulnerable_versions": "<3.0.3",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098094,
          "optional": false,
          "path": "@storybook/react>webpack>micromatch>braces",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4067",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>micromatch",
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>fork-ts-checker-webpack-plugin>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>cpy>globby>fast-glob>micromatch",
              ],
              "version": "3.1.10",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-952p-6rrq-rcjv",
          "id": 1098681,
          "metadata": null,
          "module_name": "micromatch",
          "npm_advisory_id": null,
          "overview": "The NPM package \`micromatch\` prior to version 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in \`micromatch.braces()\` in \`index.js\` because the pattern \`.*\` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persisted prior to https://github.com/micromatch/micromatch/pull/266. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching.
",
          "patched_versions": ">=4.0.8",
          "recommendation": "Upgrade to version 4.0.8 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4067
- https://github.com/micromatch/micromatch/issues/243
- https://github.com/micromatch/micromatch/pull/247
- https://devhub.checkmarx.com/cve-details/CVE-2024-4067
- https://github.com/micromatch/micromatch/blob/2c56a8604b68c1099e7bc0f807ce0865a339747a/index.js#L448
- https://github.com/micromatch/micromatch/commit/500d5d6f42f0e8dfa1cb5464c6cb420b1b6aaaa0
- https://github.com/micromatch/micromatch/pull/266
- https://github.com/micromatch/micromatch/commit/03aa8052171e878897eee5d7bb2ae0ae83ec2ade
- https://advisory.checkmarx.net/advisory/CVE-2024-4067
- https://github.com/micromatch/micromatch/releases/tag/4.0.8
- https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "reported_by": null,
          "severity": "moderate",
          "title": "Regular Expression Denial of Service (ReDoS) in micromatch",
          "updated": "2024-08-28T13:12:27.000Z",
          "url": "https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "vulnerable_versions": "<4.0.8",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098681,
          "optional": false,
          "path": "@storybook/react>webpack>micromatch",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-05-14T18:30:54.000Z",
          "cves": Array [
            "CVE-2024-4067",
          ],
          "cvss": Object {
            "score": 5.3,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>micromatch",
                "@storybook/addon-essentials>@storybook/addon-docs>@jest/transform>jest-haste-map>sane>anymatch>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>fork-ts-checker-webpack-plugin>micromatch",
              ],
              "version": "3.1.10",
            },
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>cpy>globby>fast-glob>micromatch",
              ],
              "version": "3.1.10",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-952p-6rrq-rcjv",
          "id": 1098681,
          "metadata": null,
          "module_name": "micromatch",
          "npm_advisory_id": null,
          "overview": "The NPM package \`micromatch\` prior to version 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in \`micromatch.braces()\` in \`index.js\` because the pattern \`.*\` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persisted prior to https://github.com/micromatch/micromatch/pull/266. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching.
",
          "patched_versions": ">=4.0.8",
          "recommendation": "Upgrade to version 4.0.8 or later",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4067
- https://github.com/micromatch/micromatch/issues/243
- https://github.com/micromatch/micromatch/pull/247
- https://devhub.checkmarx.com/cve-details/CVE-2024-4067
- https://github.com/micromatch/micromatch/blob/2c56a8604b68c1099e7bc0f807ce0865a339747a/index.js#L448
- https://github.com/micromatch/micromatch/commit/500d5d6f42f0e8dfa1cb5464c6cb420b1b6aaaa0
- https://github.com/micromatch/micromatch/pull/266
- https://github.com/micromatch/micromatch/commit/03aa8052171e878897eee5d7bb2ae0ae83ec2ade
- https://advisory.checkmarx.net/advisory/CVE-2024-4067
- https://github.com/micromatch/micromatch/releases/tag/4.0.8
- https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "reported_by": null,
          "severity": "moderate",
          "title": "Regular Expression Denial of Service (ReDoS) in micromatch",
          "updated": "2024-08-28T13:12:27.000Z",
          "url": "https://github.com/advisories/GHSA-952p-6rrq-rcjv",
          "vulnerable_versions": "<4.0.8",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098681,
          "optional": false,
          "path": "@storybook/react>webpack>watchpack>watchpack-chokidar2>chokidar>anymatch>micromatch",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-06-17T19:09:10.000Z",
          "cves": Array [
            "CVE-2024-37890",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-476",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>ws",
              ],
              "version": "8.4.2",
            },
            Object {
              "paths": Array [
                "jest-cli>jest-config>jest-environment-jsdom>jsdom>ws",
                "jest>@jest/core>jest-config>jest-environment-jsdom>jsdom>ws",
                "jest>jest-cli>@jest/core>jest-config>jest-environment-jsdom>jsdom>ws",
                "jest>jest-cli>@jest/core>jest-config>jest-runner>jest-environment-jsdom>jsdom>ws",
              ],
              "version": "8.4.2",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-3h5v-q93c-6h6q",
          "id": 1098392,
          "metadata": null,
          "module_name": "ws",
          "npm_advisory_id": null,
          "overview": "### Impact

A request with a number of headers exceeding the[\`server.maxHeadersCount\`][] threshold could be used to crash a ws server.

### Proof of concept

\`\`\`js
const http = require('http');
const WebSocket = require('ws');

const wss = new WebSocket.Server({ port: 0 }, function () {
  const chars = \\"!#$%&'*+-.0123456789abcdefghijklmnopqrstuvwxyz^_\`|~\\".split('');
  const headers = {};
  let count = 0;

  for (let i = 0; i < chars.length; i++) {
    if (count === 2000) break;

    for (let j = 0; j < chars.length; j++) {
      const key = chars[i] + chars[j];
      headers[key] = 'x';

      if (++count === 2000) break;
    }
  }

  headers.Connection = 'Upgrade';
  headers.Upgrade = 'websocket';
  headers['Sec-WebSocket-Key'] = 'dGhlIHNhbXBsZSBub25jZQ==';
  headers['Sec-WebSocket-Version'] = '13';

  const request = http.request({
    headers: headers,
    host: '127.0.0.1',
    port: wss.address().port
  });

  request.end();
});
\`\`\`

### Patches

The vulnerability was fixed in ws@8.17.1 (https://github.com/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c) and backported to ws@7.5.10 (https://github.com/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f), ws@6.2.3 (https://github.com/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63), and ws@5.2.4 (https://github.com/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e)

### Workarounds

In vulnerable versions of ws, the issue can be mitigated in the following ways:

1. Reduce the maximum allowed length of the request headers using the [\`--max-http-header-size=size\`][] and/or the [\`maxHeaderSize\`][] options so that no more headers than the \`server.maxHeadersCount\` limit can be sent.
2. Set \`server.maxHeadersCount\` to \`0\` so that no limit is applied.

### Credits

The vulnerability was reported by [Ryan LaPointe](https://github.com/rrlapointe) in https://github.com/websockets/ws/issues/2230.

### References

- https://github.com/websockets/ws/issues/2230
- https://github.com/websockets/ws/pull/2231

[\`--max-http-header-size=size\`]: https://nodejs.org/api/cli.html#--max-http-header-sizesize
[\`maxHeaderSize\`]: https://nodejs.org/api/http.html#httpcreateserveroptions-requestlistener
[\`server.maxHeadersCount\`]: https://nodejs.org/api/http.html#servermaxheaderscount
",
          "patched_versions": ">=8.17.1",
          "recommendation": "Upgrade to version 8.17.1 or later",
          "references": "- https://github.com/websockets/ws/security/advisories/GHSA-3h5v-q93c-6h6q
- https://github.com/websockets/ws/issues/2230
- https://github.com/websockets/ws/pull/2231
- https://github.com/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f
- https://github.com/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e
- https://github.com/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c
- https://github.com/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63
- https://github.com/advisories/GHSA-3h5v-q93c-6h6q",
          "reported_by": null,
          "severity": "high",
          "title": "ws affected by a DoS when handling a request with many HTTP headers",
          "updated": "2024-08-05T05:02:34.000Z",
          "url": "https://github.com/advisories/GHSA-3h5v-q93c-6h6q",
          "vulnerable_versions": ">=8.0.0 <8.17.1",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1098392,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>ws",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-09-10T19:42:41.000Z",
          "cves": Array [
            "CVE-2024-43799",
          ],
          "cvss": Object {
            "score": 5,
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L",
          },
          "cwe": Array [
            "CWE-79",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/core-common>express>serve-static>send",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>express>serve-static>send",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>express>serve-static>send",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>express>serve-static>send",
              ],
              "version": "0.18.0",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-m6fv-jmcg-4jfg",
          "id": 1099525,
          "metadata": null,
          "module_name": "send",
          "npm_advisory_id": null,
          "overview": "### Impact

passing untrusted user input - even after sanitizing it - to \`SendStream.redirect()\` may execute untrusted code

### Patches

this issue is patched in send 0.19.0

### Workarounds

users are encouraged to upgrade to the patched version of express, but otherwise can workaround this issue by making sure any untrusted inputs are safe, ideally by validating them against an explicit allowlist

### Details

successful exploitation of this vector requires the following:

1. The attacker MUST control the input to response.redirect()
1. express MUST NOT redirect before the template appears
1. the browser MUST NOT complete redirection before:
1. the user MUST click on the link in the template
",
          "patched_versions": ">=0.19.0",
          "recommendation": "Upgrade to version 0.19.0 or later",
          "references": "- https://github.com/pillarjs/send/security/advisories/GHSA-m6fv-jmcg-4jfg
- https://nvd.nist.gov/vuln/detail/CVE-2024-43799
- https://github.com/pillarjs/send/commit/ae4f2989491b392ae2ef3b0015a019770ae65d35
- https://github.com/advisories/GHSA-m6fv-jmcg-4jfg",
          "reported_by": null,
          "severity": "moderate",
          "title": "send vulnerable to template injection that can lead to XSS",
          "updated": "2024-09-10T19:42:42.000Z",
          "url": "https://github.com/advisories/GHSA-m6fv-jmcg-4jfg",
          "vulnerable_versions": "<0.19.0",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1099525,
          "optional": false,
          "path": "@storybook/addon-essentials>@storybook/core-common>express>serve-static>send",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-09-10T19:42:41.000Z",
          "cves": Array [
            "CVE-2024-43799",
          ],
          "cvss": Object {
            "score": 5,
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L",
          },
          "cwe": Array [
            "CWE-79",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/core-common>express>serve-static>send",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>express>serve-static>send",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>express>serve-static>send",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>express>serve-static>send",
              ],
              "version": "0.18.0",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-m6fv-jmcg-4jfg",
          "id": 1099525,
          "metadata": null,
          "module_name": "send",
          "npm_advisory_id": null,
          "overview": "### Impact

passing untrusted user input - even after sanitizing it - to \`SendStream.redirect()\` may execute untrusted code

### Patches

this issue is patched in send 0.19.0

### Workarounds

users are encouraged to upgrade to the patched version of express, but otherwise can workaround this issue by making sure any untrusted inputs are safe, ideally by validating them against an explicit allowlist

### Details

successful exploitation of this vector requires the following:

1. The attacker MUST control the input to response.redirect()
1. express MUST NOT redirect before the template appears
1. the browser MUST NOT complete redirection before:
1. the user MUST click on the link in the template
",
          "patched_versions": ">=0.19.0",
          "recommendation": "Upgrade to version 0.19.0 or later",
          "references": "- https://github.com/pillarjs/send/security/advisories/GHSA-m6fv-jmcg-4jfg
- https://nvd.nist.gov/vuln/detail/CVE-2024-43799
- https://github.com/pillarjs/send/commit/ae4f2989491b392ae2ef3b0015a019770ae65d35
- https://github.com/advisories/GHSA-m6fv-jmcg-4jfg",
          "reported_by": null,
          "severity": "moderate",
          "title": "send vulnerable to template injection that can lead to XSS",
          "updated": "2024-09-10T19:42:42.000Z",
          "url": "https://github.com/advisories/GHSA-m6fv-jmcg-4jfg",
          "vulnerable_versions": "<0.19.0",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1099525,
          "optional": false,
          "path": "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>express>serve-static>send",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-09-10T19:42:41.000Z",
          "cves": Array [
            "CVE-2024-43799",
          ],
          "cvss": Object {
            "score": 5,
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L",
          },
          "cwe": Array [
            "CWE-79",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/core-common>express>serve-static>send",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>express>serve-static>send",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>express>serve-static>send",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>express>serve-static>send",
              ],
              "version": "0.18.0",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-m6fv-jmcg-4jfg",
          "id": 1099525,
          "metadata": null,
          "module_name": "send",
          "npm_advisory_id": null,
          "overview": "### Impact

passing untrusted user input - even after sanitizing it - to \`SendStream.redirect()\` may execute untrusted code

### Patches

this issue is patched in send 0.19.0

### Workarounds

users are encouraged to upgrade to the patched version of express, but otherwise can workaround this issue by making sure any untrusted inputs are safe, ideally by validating them against an explicit allowlist

### Details

successful exploitation of this vector requires the following:

1. The attacker MUST control the input to response.redirect()
1. express MUST NOT redirect before the template appears
1. the browser MUST NOT complete redirection before:
1. the user MUST click on the link in the template
",
          "patched_versions": ">=0.19.0",
          "recommendation": "Upgrade to version 0.19.0 or later",
          "references": "- https://github.com/pillarjs/send/security/advisories/GHSA-m6fv-jmcg-4jfg
- https://nvd.nist.gov/vuln/detail/CVE-2024-43799
- https://github.com/pillarjs/send/commit/ae4f2989491b392ae2ef3b0015a019770ae65d35
- https://github.com/advisories/GHSA-m6fv-jmcg-4jfg",
          "reported_by": null,
          "severity": "moderate",
          "title": "send vulnerable to template injection that can lead to XSS",
          "updated": "2024-09-10T19:42:42.000Z",
          "url": "https://github.com/advisories/GHSA-m6fv-jmcg-4jfg",
          "vulnerable_versions": "<0.19.0",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1099525,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>express>serve-static>send",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-09-10T19:42:41.000Z",
          "cves": Array [
            "CVE-2024-43799",
          ],
          "cvss": Object {
            "score": 5,
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L",
          },
          "cwe": Array [
            "CWE-79",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/core-common>express>serve-static>send",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>express>serve-static>send",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>express>serve-static>send",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>express>serve-static>send",
              ],
              "version": "0.18.0",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-m6fv-jmcg-4jfg",
          "id": 1099525,
          "metadata": null,
          "module_name": "send",
          "npm_advisory_id": null,
          "overview": "### Impact

passing untrusted user input - even after sanitizing it - to \`SendStream.redirect()\` may execute untrusted code

### Patches

this issue is patched in send 0.19.0

### Workarounds

users are encouraged to upgrade to the patched version of express, but otherwise can workaround this issue by making sure any untrusted inputs are safe, ideally by validating them against an explicit allowlist

### Details

successful exploitation of this vector requires the following:

1. The attacker MUST control the input to response.redirect()
1. express MUST NOT redirect before the template appears
1. the browser MUST NOT complete redirection before:
1. the user MUST click on the link in the template
",
          "patched_versions": ">=0.19.0",
          "recommendation": "Upgrade to version 0.19.0 or later",
          "references": "- https://github.com/pillarjs/send/security/advisories/GHSA-m6fv-jmcg-4jfg
- https://nvd.nist.gov/vuln/detail/CVE-2024-43799
- https://github.com/pillarjs/send/commit/ae4f2989491b392ae2ef3b0015a019770ae65d35
- https://github.com/advisories/GHSA-m6fv-jmcg-4jfg",
          "reported_by": null,
          "severity": "moderate",
          "title": "send vulnerable to template injection that can lead to XSS",
          "updated": "2024-09-10T19:42:42.000Z",
          "url": "https://github.com/advisories/GHSA-m6fv-jmcg-4jfg",
          "vulnerable_versions": "<0.19.0",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1099525,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>express>serve-static>send",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-10-04T20:31:00.000Z",
          "cves": Array [
            "CVE-2024-47764",
          ],
          "cvss": Object {
            "score": 0,
            "vectorString": null,
          },
          "cwe": Array [
            "CWE-74",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/core-common>express>cookie",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>express>cookie",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>express>cookie",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>express>cookie",
              ],
              "version": "0.6.0",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-pxg6-pf52-xh8x",
          "id": 1099846,
          "metadata": null,
          "module_name": "cookie",
          "npm_advisory_id": null,
          "overview": "### Impact

The cookie name could be used to set other fields of the cookie, resulting in an unexpected cookie value. For example, \`serialize(\\"userName=<script>alert('XSS3')</script>; Max-Age=2592000; a\\", value)\` would result in \`\\"userName=<script>alert('XSS3')</script>; Max-Age=2592000; a=test\\"\`, setting \`userName\` cookie to \`<script>\` and ignoring \`value\`.

A similar escape can be used for \`path\` and \`domain\`, which could be abused to alter other fields of the cookie.

### Patches

Upgrade to 0.7.0, which updates the validation for \`name\`, \`path\`, and \`domain\`.

### Workarounds

Avoid passing untrusted or arbitrary values for these fields, ensure they are set by the application instead of user input.

### References

* https://github.com/jshttp/cookie/pull/167",
          "patched_versions": ">=0.7.0",
          "recommendation": "Upgrade to version 0.7.0 or later",
          "references": "- https://github.com/jshttp/cookie/security/advisories/GHSA-pxg6-pf52-xh8x
- https://github.com/jshttp/cookie/pull/167
- https://github.com/jshttp/cookie/commit/e10042845354fea83bd8f34af72475eed1dadf5c
- https://github.com/advisories/GHSA-pxg6-pf52-xh8x",
          "reported_by": null,
          "severity": "low",
          "title": "cookie accepts cookie name, path, and domain with out of bounds characters",
          "updated": "2024-10-04T20:31:01.000Z",
          "url": "https://github.com/advisories/GHSA-pxg6-pf52-xh8x",
          "vulnerable_versions": "<0.7.0",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1099846,
          "optional": false,
          "path": "@storybook/addon-essentials>@storybook/core-common>express>cookie",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-10-04T20:31:00.000Z",
          "cves": Array [
            "CVE-2024-47764",
          ],
          "cvss": Object {
            "score": 0,
            "vectorString": null,
          },
          "cwe": Array [
            "CWE-74",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/core-common>express>cookie",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>express>cookie",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>express>cookie",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>express>cookie",
              ],
              "version": "0.6.0",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-pxg6-pf52-xh8x",
          "id": 1099846,
          "metadata": null,
          "module_name": "cookie",
          "npm_advisory_id": null,
          "overview": "### Impact

The cookie name could be used to set other fields of the cookie, resulting in an unexpected cookie value. For example, \`serialize(\\"userName=<script>alert('XSS3')</script>; Max-Age=2592000; a\\", value)\` would result in \`\\"userName=<script>alert('XSS3')</script>; Max-Age=2592000; a=test\\"\`, setting \`userName\` cookie to \`<script>\` and ignoring \`value\`.

A similar escape can be used for \`path\` and \`domain\`, which could be abused to alter other fields of the cookie.

### Patches

Upgrade to 0.7.0, which updates the validation for \`name\`, \`path\`, and \`domain\`.

### Workarounds

Avoid passing untrusted or arbitrary values for these fields, ensure they are set by the application instead of user input.

### References

* https://github.com/jshttp/cookie/pull/167",
          "patched_versions": ">=0.7.0",
          "recommendation": "Upgrade to version 0.7.0 or later",
          "references": "- https://github.com/jshttp/cookie/security/advisories/GHSA-pxg6-pf52-xh8x
- https://github.com/jshttp/cookie/pull/167
- https://github.com/jshttp/cookie/commit/e10042845354fea83bd8f34af72475eed1dadf5c
- https://github.com/advisories/GHSA-pxg6-pf52-xh8x",
          "reported_by": null,
          "severity": "low",
          "title": "cookie accepts cookie name, path, and domain with out of bounds characters",
          "updated": "2024-10-04T20:31:01.000Z",
          "url": "https://github.com/advisories/GHSA-pxg6-pf52-xh8x",
          "vulnerable_versions": "<0.7.0",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1099846,
          "optional": false,
          "path": "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>express>cookie",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-10-04T20:31:00.000Z",
          "cves": Array [
            "CVE-2024-47764",
          ],
          "cvss": Object {
            "score": 0,
            "vectorString": null,
          },
          "cwe": Array [
            "CWE-74",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/core-common>express>cookie",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>express>cookie",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>express>cookie",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>express>cookie",
              ],
              "version": "0.6.0",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-pxg6-pf52-xh8x",
          "id": 1099846,
          "metadata": null,
          "module_name": "cookie",
          "npm_advisory_id": null,
          "overview": "### Impact

The cookie name could be used to set other fields of the cookie, resulting in an unexpected cookie value. For example, \`serialize(\\"userName=<script>alert('XSS3')</script>; Max-Age=2592000; a\\", value)\` would result in \`\\"userName=<script>alert('XSS3')</script>; Max-Age=2592000; a=test\\"\`, setting \`userName\` cookie to \`<script>\` and ignoring \`value\`.

A similar escape can be used for \`path\` and \`domain\`, which could be abused to alter other fields of the cookie.

### Patches

Upgrade to 0.7.0, which updates the validation for \`name\`, \`path\`, and \`domain\`.

### Workarounds

Avoid passing untrusted or arbitrary values for these fields, ensure they are set by the application instead of user input.

### References

* https://github.com/jshttp/cookie/pull/167",
          "patched_versions": ">=0.7.0",
          "recommendation": "Upgrade to version 0.7.0 or later",
          "references": "- https://github.com/jshttp/cookie/security/advisories/GHSA-pxg6-pf52-xh8x
- https://github.com/jshttp/cookie/pull/167
- https://github.com/jshttp/cookie/commit/e10042845354fea83bd8f34af72475eed1dadf5c
- https://github.com/advisories/GHSA-pxg6-pf52-xh8x",
          "reported_by": null,
          "severity": "low",
          "title": "cookie accepts cookie name, path, and domain with out of bounds characters",
          "updated": "2024-10-04T20:31:01.000Z",
          "url": "https://github.com/advisories/GHSA-pxg6-pf52-xh8x",
          "vulnerable_versions": "<0.7.0",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1099846,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>express>cookie",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-10-04T20:31:00.000Z",
          "cves": Array [
            "CVE-2024-47764",
          ],
          "cvss": Object {
            "score": 0,
            "vectorString": null,
          },
          "cwe": Array [
            "CWE-74",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/addon-essentials>@storybook/core-common>express>cookie",
                "@storybook/addon-essentials>@storybook/addon-controls>@storybook/core-common>express>cookie",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/core-common>express>cookie",
                "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>express>cookie",
              ],
              "version": "0.6.0",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-pxg6-pf52-xh8x",
          "id": 1099846,
          "metadata": null,
          "module_name": "cookie",
          "npm_advisory_id": null,
          "overview": "### Impact

The cookie name could be used to set other fields of the cookie, resulting in an unexpected cookie value. For example, \`serialize(\\"userName=<script>alert('XSS3')</script>; Max-Age=2592000; a\\", value)\` would result in \`\\"userName=<script>alert('XSS3')</script>; Max-Age=2592000; a=test\\"\`, setting \`userName\` cookie to \`<script>\` and ignoring \`value\`.

A similar escape can be used for \`path\` and \`domain\`, which could be abused to alter other fields of the cookie.

### Patches

Upgrade to 0.7.0, which updates the validation for \`name\`, \`path\`, and \`domain\`.

### Workarounds

Avoid passing untrusted or arbitrary values for these fields, ensure they are set by the application instead of user input.

### References

* https://github.com/jshttp/cookie/pull/167",
          "patched_versions": ">=0.7.0",
          "recommendation": "Upgrade to version 0.7.0 or later",
          "references": "- https://github.com/jshttp/cookie/security/advisories/GHSA-pxg6-pf52-xh8x
- https://github.com/jshttp/cookie/pull/167
- https://github.com/jshttp/cookie/commit/e10042845354fea83bd8f34af72475eed1dadf5c
- https://github.com/advisories/GHSA-pxg6-pf52-xh8x",
          "reported_by": null,
          "severity": "low",
          "title": "cookie accepts cookie name, path, and domain with out of bounds characters",
          "updated": "2024-10-04T20:31:01.000Z",
          "url": "https://github.com/advisories/GHSA-pxg6-pf52-xh8x",
          "vulnerable_versions": "<0.7.0",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1099846,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>@storybook/builder-webpack4>@storybook/core-common>express>cookie",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-09-09T20:19:15.000Z",
          "cves": Array [
            "CVE-2024-45296",
          ],
          "cvss": Object {
            "score": 7.5,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          },
          "cwe": Array [
            "CWE-1333",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "jest-html-reporter>sinon>nise>path-to-regexp",
              ],
              "version": "1.8.0",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-9wv6-86v2-598j",
          "id": 1099561,
          "metadata": null,
          "module_name": "path-to-regexp",
          "npm_advisory_id": null,
          "overview": "### Impact

A bad regular expression is generated any time you have two parameters within a single segment, separated by something that is not a period (\`.\`). For example, \`/:a-:b\`.

### Patches

For users of 0.1, upgrade to \`0.1.10\`. All other users should upgrade to \`8.0.0\`.

These versions add backtrack protection when a custom regex pattern is not provided:

- [0.1.10](https://github.com/pillarjs/path-to-regexp/releases/tag/v0.1.10)
- [1.9.0](https://github.com/pillarjs/path-to-regexp/releases/tag/v1.9.0)
- [3.3.0](https://github.com/pillarjs/path-to-regexp/releases/tag/v3.3.0)
- [6.3.0](https://github.com/pillarjs/path-to-regexp/releases/tag/v6.3.0)

They do not protect against vulnerable user supplied capture groups. Protecting against explicit user patterns is out of scope for old versions and not considered a vulnerability.

Version [7.1.0](https://github.com/pillarjs/path-to-regexp/releases/tag/v7.1.0) can enable \`strict: true\` and get an error when the regular expression might be bad.

Version [8.0.0](https://github.com/pillarjs/path-to-regexp/releases/tag/v8.0.0) removes the features that can cause a ReDoS.

### Workarounds

All versions can be patched by providing a custom regular expression for parameters after the first in a single segment. As long as the custom regular expression does not match the text before the parameter, you will be safe. For example, change \`/:a-:b\` to \`/:a-:b([^-/]+)\`.

If paths cannot be rewritten and versions cannot be upgraded, another alternative is to limit the URL length. For example, halving the attack string improves performance by 4x faster.

### Details

Using \`/:a-:b\` will produce the regular expression \`/^\\\\/([^\\\\/]+?)-([^\\\\/]+?)\\\\/?$/\`. This can be exploited by a path such as \`/a\${'-a'.repeat(8_000)}/a\`. [OWASP](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS) has a good example of why this occurs, but the TL;DR is the \`/a\` at the end ensures this route would never match but due to naive backtracking it will still attempt every combination of the \`:a-:b\` on the repeated 8,000 \`-a\`.

Because JavaScript is single threaded and regex matching runs on the main thread, poor performance will block the event loop and can lead to a DoS. In local benchmarks, exploiting the unsafe regex will result in performance that is over 1000x worse than the safe regex. In a more realistic environment using Express v4 and 10 concurrent connections, this translated to average latency of ~600ms vs 1ms.

### References

* [OWASP](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS)
* [Detailed blog post](https://blakeembrey.com/posts/2024-09-web-redos/)",
          "patched_versions": ">=1.9.0",
          "recommendation": "Upgrade to version 1.9.0 or later",
          "references": "- https://github.com/pillarjs/path-to-regexp/security/advisories/GHSA-9wv6-86v2-598j
- https://github.com/pillarjs/path-to-regexp/commit/29b96b4a1de52824e1ca0f49a701183cc4ed476f
- https://github.com/pillarjs/path-to-regexp/commit/60f2121e9b66b7b622cc01080df0aabda9eedee6
- https://nvd.nist.gov/vuln/detail/CVE-2024-45296
- https://github.com/pillarjs/path-to-regexp/commit/925ac8e3c5780b02f58cbd4e52f95da8ad2ac485
- https://github.com/pillarjs/path-to-regexp/commit/d31670ae8f6e69cbfd56e835742195b7d10942ef
- https://github.com/pillarjs/path-to-regexp/commit/f1253b47b347dcb909e3e80b0eb2649109e59894
- https://github.com/pillarjs/path-to-regexp/releases/tag/v6.3.0
- https://github.com/advisories/GHSA-9wv6-86v2-598j",
          "reported_by": null,
          "severity": "high",
          "title": "path-to-regexp outputs backtracking regular expressions",
          "updated": "2024-09-12T17:09:43.000Z",
          "url": "https://github.com/advisories/GHSA-9wv6-86v2-598j",
          "vulnerable_versions": ">=0.2.0 <1.9.0",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1099561,
          "optional": false,
          "path": "jest-html-reporter>sinon>nise>path-to-regexp",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2021-05-06T16:05:51.000Z",
          "cves": Array [
            "CVE-2021-23337",
          ],
          "cvss": Object {
            "score": 7.2,
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
          },
          "cwe": Array [
            "CWE-77",
            "CWE-94",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "workbox-build>lodash.template",
              ],
              "version": "4.5.0",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-35jh-r3h4-6jhm",
          "id": 1096993,
          "metadata": null,
          "module_name": "lodash.template",
          "npm_advisory_id": null,
          "overview": "\`lodash\` versions prior to 4.17.21 are vulnerable to Command Injection via the template function.",
          "patched_versions": "<0.0.0",
          "recommendation": "None",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2021-23337
- https://github.com/lodash/lodash/commit/3469357cff396a26c363f8c1b5a91dde28ba4b1c
- https://snyk.io/vuln/SNYK-JS-LODASH-1040724
- https://github.com/lodash/lodash/blob/ddfd9b11a0126db2302cb70ec9973b66baec0975/lodash.js#L14851
- https://github.com/lodash/lodash/blob/ddfd9b11a0126db2302cb70ec9973b66baec0975/lodash.js%23L14851
- https://snyk.io/vuln/SNYK-JAVA-ORGFUJIONWEBJARS-1074932
- https://snyk.io/vuln/SNYK-JAVA-ORGWEBJARS-1074930
- https://snyk.io/vuln/SNYK-JAVA-ORGWEBJARSBOWER-1074928
- https://snyk.io/vuln/SNYK-JAVA-ORGWEBJARSBOWERGITHUBLODASH-1074931
- https://snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-1074929
- https://www.oracle.com//security-alerts/cpujul2021.html
- https://www.oracle.com/security-alerts/cpuoct2021.html
- https://www.oracle.com/security-alerts/cpujan2022.html
- https://www.oracle.com/security-alerts/cpujul2022.html
- https://cert-portal.siemens.com/productcert/pdf/ssa-637483.pdf
- https://security.netapp.com/advisory/ntap-20210312-0006
- https://github.com/advisories/GHSA-35jh-r3h4-6jhm",
          "reported_by": null,
          "severity": "high",
          "title": "Command Injection in lodash",
          "updated": "2024-04-17T18:39:19.000Z",
          "url": "https://github.com/advisories/GHSA-35jh-r3h4-6jhm",
          "vulnerable_versions": "<=4.5.0",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1096993,
          "optional": false,
          "path": "workbox-build>lodash.template",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "advisory": Object {
          "access": "public",
          "created": "2024-06-02T22:29:29.000Z",
          "cves": Array [
            "CVE-2024-29415",
          ],
          "cvss": Object {
            "score": 8.1,
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
          },
          "cwe": Array [
            "CWE-918",
          ],
          "deleted": null,
          "findings": Array [
            Object {
              "paths": Array [
                "@storybook/react>@storybook/core>@storybook/core-server>ip",
              ],
              "version": "2.0.1",
            },
          ],
          "found_by": null,
          "github_advisory_id": "GHSA-2p57-rm9w-gvfp",
          "id": 1099357,
          "metadata": null,
          "module_name": "ip",
          "npm_advisory_id": null,
          "overview": "The ip package through 2.0.1 for Node.js might allow SSRF because some IP addresses (such as 127.1, 01200034567, 012.1.2.3, 000:0:0000::01, and ::fFFf:127.0.0.1) are improperly categorized as globally routable via isPublic. NOTE: this issue exists because of an incomplete fix for CVE-2023-42282.",
          "patched_versions": "<0.0.0",
          "recommendation": "None",
          "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-29415
- https://github.com/indutny/node-ip/issues/150
- https://github.com/indutny/node-ip/pull/143
- https://github.com/indutny/node-ip/pull/144
- https://github.com/advisories/GHSA-2p57-rm9w-gvfp",
          "reported_by": null,
          "severity": "high",
          "title": "ip SSRF improper categorization in isPublic",
          "updated": "2024-09-03T19:59:02.000Z",
          "url": "https://github.com/advisories/GHSA-2p57-rm9w-gvfp",
          "vulnerable_versions": "<=2.0.1",
        },
        "resolution": Object {
          "bundled": false,
          "dev": false,
          "id": 1099357,
          "optional": false,
          "path": "@storybook/react>@storybook/core>@storybook/core-server>ip",
        },
      },
      "type": "auditAdvisory",
    },
    Object {
      "data": Object {
        "dependencies": 2454,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 2454,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 20,
          "info": 0,
          "low": 4,
          "moderate": 32,
        },
      },
      "type": "auditSummary",
    },
  ],
  "world-map": Array [
    Object {
      "data": Object {
        "dependencies": 30,
        "devDependencies": 0,
        "optionalDependencies": 0,
        "totalDependencies": 30,
        "vulnerabilities": Object {
          "critical": 0,
          "high": 0,
          "info": 0,
          "low": 0,
          "moderate": 0,
        },
      },
      "type": "auditSummary",
    },
  ],
}
`;
